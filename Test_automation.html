<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.4.0"/>
    <title>Test_automation API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Utils">Utils</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Utils.__init__">Utils</a>
                        </li>
                        <li>
                                <a class="variable" href="#Utils.storage_name">storage_name</a>
                        </li>
                        <li>
                                <a class="variable" href="#Utils.scope">scope</a>
                        </li>
                        <li>
                                <a class="variable" href="#Utils.key">key</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.connect_storage">connect_storage</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.new_df">new_df</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.new_col">new_col</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.renamed_col">renamed_col</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.dropped_col">dropped_col</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.conversion_type">conversion_type</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.csv_to_df">csv_to_df</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.xlsx_to_df">xlsx_to_df</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.txt_to_df">txt_to_df</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.json_to_df">json_to_df</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.parquet_to_df">parquet_to_df</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.function_df_input">function_df_input</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.file_result_df_input">file_result_df_input</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.function_csv_input">function_csv_input</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.function_txt_input">function_txt_input</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.function_xlsx_input">function_xlsx_input</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.function_json_input">function_json_input</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.function_parquet_input">function_parquet_input</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.duplicates_df">duplicates_df</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.duplicates_col">duplicates_col</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.filter_by_condition">filter_by_condition</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.filter_by_df">filter_by_df</a>
                        </li>
                        <li>
                                <a class="function" href="#Utils.write_df">write_df</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
Test_automation    </h1>

                
                        <input id="mod-Test_automation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-Test_automation-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">from</span> <span class="nn">pyspark.sql</span> <span class="kn">import</span> <span class="n">DataFrame</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="n">IntegerType</span><span class="p">,</span> <span class="n">StringType</span><span class="p">,</span> <span class="n">StructField</span> <span class="p">,</span> <span class="n">StructType</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">from</span> <span class="nn">pyspark.testing.utils</span> <span class="kn">import</span> <span class="n">assertDataFrameEqual</span> <span class="p">,</span> <span class="n">assertSchemaEqual</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="k">class</span> <span class="nc">Utils</span><span class="p">:</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>    <span class="n">__test__</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a>    <span class="n">storage_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>    <span class="n">scope</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">        Initializes the class with the given storage name, scope, and key.</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">        </span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">        Parameters:</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">            - &#39;storage_name&#39; (str): The name of the storage.</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">            - &#39;scope&#39; (str, optional): The scope of the storage.</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">            - &#39;key&#39; (str, optional): The key for the storage.</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">            </span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="sd">        Returns:</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">            None.</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">        &quot;&quot;&quot;</span>   
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage_name</span> <span class="o">=</span> <span class="n">storage_name</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scope</span> <span class="o">=</span> <span class="n">scope</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>    <span class="k">def</span> <span class="nf">connect_storage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="w">        </span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">        Connects to the storage using the given scope and key.</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">        </span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">        Parameters:</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">            </span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">            - None.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">            </span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        Returns:</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">            None. Sets the configuration for the Azure Data Lake Storage Gen2 account.</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>        <span class="n">ADLS2AccountKey</span> <span class="o">=</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">secrets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>        <span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;fs.azure.account.key.&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_name</span> <span class="o">+</span> <span class="s2">&quot;.dfs.core.windows.net&quot;</span><span class="p">,</span> <span class="n">ADLS2AccountKey</span><span class="p">)</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>    <span class="k">def</span> <span class="nf">new_df</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">new_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">expected_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">        Tests the creation of a new dataframe by comparing the created dataframe and its schema to an expected dataframe and an expected schema.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">        </span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">        Parameters:</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a><span class="sd">            </span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="sd">            - new_df (DataFrame): The newly created DataFrame. </span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="sd">            </span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="sd">            - expected_df (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        Returns:</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">            None. Raises an AssertionError if the dataframes or schemas do not match.</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>        <span class="n">df_schema</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">schema</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>        <span class="n">expected_schema</span> <span class="o">=</span> <span class="n">expected_df</span><span class="o">.</span><span class="n">schema</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">new_df</span> <span class="p">,</span> <span class="n">expected_df</span><span class="p">),</span> <span class="s2">&quot;The newly created DataFrame does not match the expected DataFrame.&quot;</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>        <span class="n">assertSchemaEqual</span><span class="p">(</span><span class="n">df_schema</span> <span class="p">,</span> <span class="n">expected_schema</span><span class="p">),</span> <span class="s2">&quot;The schema of the newly created DataFrame does not match the expected schema.&quot;</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>    <span class="k">def</span> <span class="nf">new_col</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">new_col</span> <span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">expected_type_new_col</span> <span class="p">:</span> <span class="nb">type</span> <span class="p">,</span> <span class="n">expected_nullable</span> <span class="p">:</span> <span class="nb">bool</span> <span class="p">,</span> <span class="n">initial_df</span> <span class="p">:</span> <span class="n">DataFrame</span> <span class="p">,</span> <span class="n">final_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">        Tests the creation of a new column in a dataframe by comparing the final dataframe to the initial dataframe.</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">        </span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        Parameters:</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">            - &#39;new_col&#39; (str): The name of the newly created column.</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">            - &#39;expected_type_new_col&#39; (type): The expected data type of the new column.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">            - &#39;expected_nullable&#39; (bool): The expected nullable property of the new column.</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">            - &#39;initial_df&#39; (DataFrame): The initial DataFrame before the new column is added.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">            - &#39;final_df&#39; (DataFrame): The final DataFrame after the new column is added.</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">            </span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        Returns:</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">            None. Raises an AssertionError if the new column or its properties do not match the expectations.</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="k">assert</span> <span class="n">new_col</span> <span class="ow">in</span> <span class="n">final_df</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span><span class="s2">&quot;The new column does not exist in the final DataFrame.&quot;</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>        <span class="k">assert</span> <span class="n">new_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">initial_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;The new column already exists in the initial DataFrame.&quot;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="k">assert</span> <span class="n">final_df</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span><span class="o">.</span><span class="n">dataType</span> <span class="o">==</span> <span class="n">expected_type_new_col</span> <span class="p">,</span> <span class="s2">&quot;The data type of the new column does not match the expected data type.&quot;</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>        <span class="k">assert</span> <span class="n">final_df</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span><span class="o">.</span><span class="n">nullable</span> <span class="o">==</span> <span class="n">expected_nullable</span> <span class="p">,</span> <span class="s2">&quot;The nullable property of the new column does not match the expected nullable property.&quot;</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>    
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    <span class="k">def</span> <span class="nf">renamed_col</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">renamed_df</span> <span class="p">:</span> <span class="n">DataFrame</span> <span class="p">,</span> <span class="n">expected_df</span> <span class="p">:</span> <span class="n">DataFrame</span> <span class="p">):</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        Tests the renaming of columns in a dataframe by comparing the renamed dataframe and its schema to an expected dataframe.</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        </span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        Parameters:</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">            - &#39;renamed_df&#39; (DataFrame): The DataFrame after the columns have been renamed.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">            </span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        Returns:</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">            None. Raises an AssertionError if the dataframes or schemas do not match the expectations.</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="n">renamed_schema</span> <span class="o">=</span> <span class="n">renamed_df</span><span class="o">.</span><span class="n">schema</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="n">expected_schema</span> <span class="o">=</span> <span class="n">expected_df</span><span class="o">.</span><span class="n">schema</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">renamed_df</span> <span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The DataFrame after renaming columns does not match the expected DataFrame.&quot;</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="n">assertSchemaEqual</span><span class="p">(</span><span class="n">renamed_schema</span> <span class="p">,</span> <span class="n">expected_schema</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The schema of the DataFrame after renaming columns does not match the expected schema.&quot;</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>    
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>    <span class="k">def</span> <span class="nf">dropped_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dropped_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">dropped_col</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="w">            </span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">        Tests the dropping of columns in a dataframe by comparing the dataframe after columns have been dropped to an expected dataframe.</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a><span class="sd">        </span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">        Parameters:</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">            - &#39;dropped_df&#39; (DataFrame): The DataFrame after the columns have been dropped.</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="sd">            - &#39;dropped_col&#39; (list): The list of columns that have been dropped.</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">            </span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">        Returns:</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">            None. Raises an AssertionError if the dataframes do not match or if the dropped columns still exist in the dataframe.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">dropped_df</span> <span class="p">,</span> <span class="n">expected_df</span><span class="p">),</span>  <span class="s2">&quot;The DataFrame after dropping columns does not match the expected DataFrame.&quot;</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>        <span class="k">for</span> <span class="n">colonne</span> <span class="ow">in</span> <span class="n">dropped_col</span><span class="p">:</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>            <span class="k">assert</span> <span class="n">colonne</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dropped_df</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The column &#39;</span><span class="si">{</span><span class="n">colonne</span><span class="si">}</span><span class="s2">&#39; was not successfully dropped from the DataFrame.&quot;</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">conversion_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">convert_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">convert_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">expected_type</span> <span class="p">:</span> <span class="nb">type</span><span class="p">):</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a><span class="sd">        Tests the conversion of a column&#39;s data type in a dataframe.</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">        </span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">        Parameters:</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">            - &#39;convert_df&#39; (DataFrame): The DataFrame after the column&#39;s data type has been converted.</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">            - &#39;convert_col&#39; (str): The name of the column whose data type has been converted.</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">            - &#39;expected_type&#39; (type): The expected data type of the converted column.</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">            </span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a><span class="sd">        Returns:</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">            None. Raises an AssertionError if the data type of the converted column does not match the expected data type.</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="k">assert</span> <span class="n">convert_df</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">convert_col</span><span class="p">]</span><span class="o">.</span><span class="n">dataType</span> <span class="o">==</span> <span class="n">expected_type</span> <span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The data type of column &#39;</span><span class="si">{</span><span class="n">convert_col</span><span class="si">}</span><span class="s2">&#39; does not match the expected type (</span><span class="si">{</span><span class="n">expected_type</span><span class="si">}</span><span class="s2">).&quot;</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    <span class="k">def</span> <span class="nf">csv_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">        Converts a CSV file to a DataFrame.</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">        </span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">        Parameters:</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the CSV file.</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;csv&#39;.</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">                    </span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">        Returns:</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the CSV file.</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;csv&quot;</span><span class="p">:</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>            
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>            
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>            <span class="k">return</span> <span class="n">expected_df</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>    
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>    <span class="k">def</span> <span class="nf">xlsx_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">        Converts an XLSX file to a DataFrame.</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">        </span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">        Parameters:</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the XLSX file.</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;xlsx&#39;.</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.           </span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">            </span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a><span class="sd">        Returns:</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the XLSX file.</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">:</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>            
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="k">return</span> <span class="n">expected_df</span> 
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>         
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>    <span class="k">def</span> <span class="nf">txt_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span> 
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">        Converts a TXT file to a DataFrame.</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">        </span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">        Parameters:</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the TXT file.</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;txt&#39;.</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.            </span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a><span class="sd">            </span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a><span class="sd">        Returns:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the TXT file.</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>        
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;txt&quot;</span> <span class="p">:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>           
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>            
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>            <span class="k">return</span> <span class="n">expected_df</span> 
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>        
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>    <span class="k">def</span> <span class="nf">json_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span> 
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="w">        </span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">        Converts a JSON file to a DataFrame.</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">        </span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">        Parameters:</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the JSON file.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;json&#39;.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.           </span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">            </span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">        Returns:</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the JSON file.</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;json&quot;</span> <span class="p">:</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;json&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> 
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>            <span class="k">return</span> <span class="n">expected_df</span>  
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>        
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>    <span class="k">def</span> <span class="nf">parquet_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="w">        </span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">        Converts a Parquet file to a DataFrame.</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">        </span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">        Parameters:</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the Parquet file.</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;parquet&#39;.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.           </span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">            </span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">        Returns:</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the Parquet file.</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="sd">        &quot;&quot;&quot;</span>    
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;parquet&quot;</span> <span class="p">:</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;parquet&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> 
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>            <span class="k">return</span> <span class="n">expected_df</span>  
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>        
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>    <span class="k">def</span> <span class="nf">function_df_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame.</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">        </span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">        Parameters:</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">            </span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">        Returns:</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>        <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">expected_df</span><span class="p">,</span> <span class="n">df_result</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>    <span class="k">def</span> <span class="nf">file_result_df_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a><span class="sd">        Reads a DataFrame from a specified file path using the given file type and options.</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a><span class="sd">        Compares the resulting DataFrame with an expected DataFrame for equality.</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a><span class="sd">        </span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="sd">        Parameters:</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file to be read.</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">            - &#39;file_type&#39; (str): The format of the file (e.g., &#39;parquet&#39;, &#39;csv&#39;, etc.).</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="sd">            - &#39;options&#39; (dict, optional): Additional options for reading the file (default: {}).</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a><span class="sd">            </span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a><span class="sd">        Returns:</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame read from the file does not match the expected DataFrame.</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>        <span class="n">df_result</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_type</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">expected_df</span><span class="p">,</span> <span class="n">df_result</span><span class="p">),</span> <span class="s2">&quot;The output DataFrame does not match the expected DataFrame.&quot;</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>    <span class="k">def</span> <span class="nf">function_csv_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a CSV file.</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a><span class="sd">        </span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a><span class="sd">        Parameters:</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;csv&#39;.</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a><span class="sd">            </span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a><span class="sd">        Returns:</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;csv&quot;</span><span class="p">:</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>        
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>    
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>    <span class="k">def</span> <span class="nf">function_txt_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a TXT file.</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a><span class="sd">        </span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">        Parameters:</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;txt&#39;.</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">        Returns:</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;txt&quot;</span><span class="p">:</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>    <span class="k">def</span> <span class="nf">function_xlsx_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from an XLSX file.</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">        </span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="sd">        Parameters:</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;xlsx&#39;.</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a><span class="sd">        </span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a><span class="sd">            </span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a><span class="sd">        Returns:</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;xlsx&quot;</span><span class="p">:</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>            <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">expected_df</span><span class="p">,</span> <span class="n">df_result</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>    
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span> 
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>    <span class="k">def</span> <span class="nf">function_json_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a JSON file.</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a><span class="sd">        </span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a><span class="sd">        Parameters:</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;json&#39;.</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">        Returns:</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;json&quot;</span><span class="p">:</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>    <span class="k">def</span> <span class="nf">function_parquet_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span> <span class="p">):</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a><span class="w">        </span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a Parquet file.</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a><span class="sd">        </span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a><span class="sd">        Parameters:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;parquet&#39;.</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="sd">        Returns:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">:</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;parquet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>       
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span> 
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>        
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>    <span class="k">def</span> <span class="nf">duplicates_df</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">df_to_test</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">        Checks if a DataFrame has duplicate rows.</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a><span class="sd">        </span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">        This function counts the total number of rows and the number of distinct rows in the DataFrame. </span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="sd">        If the two counts are not equal, it means there are duplicate rows in the DataFrame, and the function raises an AssertionError.</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a><span class="sd">        </span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a><span class="sd">        Parameters:</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">            - &#39;df_to_test&#39; (DataFrame): The DataFrame to be checked for duplicates.</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a><span class="sd">            </span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a><span class="sd">        Returns:</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame has duplicate values.</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>        <span class="n">duplicate_df</span> <span class="o">=</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="n">df_to_test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;count &gt; 1&quot;</span><span class="p">)</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">duplicate_df</span><span class="p">)</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>        <span class="k">assert</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="p">,</span> <span class="s2">&quot;There are duplicate entries in the DataFrame.&quot;</span> 
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>    <span class="k">def</span> <span class="nf">duplicates_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_to_test</span> <span class="p">:</span> <span class="n">DataFrame</span> <span class="p">,</span> <span class="n">col_name</span> <span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a><span class="sd">        Checks if a column in a DataFrame has duplicate values.</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="sd">        </span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a><span class="sd">        This function counts the total number of values and the number of distinct values in the specified column of the DataFrame. </span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="sd">        If the two counts are not equal, it means there are duplicate values in the column, and the function raises an AssertionError.</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="sd">        </span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="sd">        Parameters:</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">            - &#39;df_to_test&#39; (DataFrame): The DataFrame to be checked for duplicates.</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a><span class="sd">            - &#39;col_name&#39; (str): The name of the column to be checked for duplicates.</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a><span class="sd">            </span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a><span class="sd">        Returns:</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a><span class="sd">            None. Raises an AssertionError if the column in the DataFrame has duplicate values.</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>        
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>        <span class="n">duplicate_df</span> <span class="o">=</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="n">df_to_test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;count &gt; 1&quot;</span><span class="p">)</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">duplicate_df</span><span class="p">)</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>        <span class="k">for</span> <span class="n">colonne</span> <span class="ow">in</span> <span class="n">col_name</span><span class="p">:</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>            <span class="k">assert</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">colonne</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">colonne</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="s2">&quot;There are duplicate entries in the DataFrame.&quot;</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>    <span class="k">def</span> <span class="nf">filter_by_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">condition</span> <span class="p">,</span> <span class="n">expected_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a><span class="sd">        This function filters a DataFrame based on a provided condition and then checks the filtered DataFrame against an expected DataFrame.</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a><span class="sd">        </span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a><span class="sd">        It applies a filter to the DataFrame based on the provided condition. The filtered DataFrame is then checked against the expected DataFrame using the `filter_by_df` function.</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a><span class="sd">        </span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a><span class="sd">        Parameters:</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a><span class="sd">            - &#39;filter_df&#39; (DataFrame): The DataFrame to be filtered.</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a><span class="sd">            - &#39;condition&#39;: The condition to be used for filtering the DataFrame.</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame after filtering.</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a><span class="sd">                </span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a><span class="sd">        Returns:</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a><span class="sd">            None. The function will raise an AssertionError if the filtered DataFrame does not match the expected DataFrame.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>        <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">filter_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>        <span class="n">Utils</span><span class="o">.</span><span class="n">filter_by_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_df</span> <span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>    <span class="k">def</span> <span class="nf">filter_by_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">expected_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a><span class="sd">        This function checks if a filtered DataFrame matches an expected DataFrame.</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="sd">        </span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a><span class="sd">        It applies a filter to the DataFrame based on the provided condition. Then, it checks if any rows from the filtered DataFrame exist in the unfiltered DataFrame. If they do, an AssertionError is raised. Finally, it checks if the filtered DataFrame matches the expected DataFrame using the `assertDataFrameEqual` function.</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a><span class="sd">        </span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a><span class="sd">        Parameters:</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a><span class="sd">            - &#39;filter_df&#39; (DataFrame) : The DataFrame to be filtered.</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame) : The expected DataFrame after filtering.</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a><span class="sd">                </span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a><span class="sd">        Returns:</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a><span class="sd">            None. Raises an AssertionError if the filtered DataFrame does not match the expected DataFrame or if any rows from the filtered DataFrame exist in the unfiltered DataFrame.</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>        <span class="n">df_unfiltered</span> <span class="o">=</span> <span class="n">filter_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">expected_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">filter_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left_anti&quot;</span><span class="p">)</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>        <span class="n">df_filtered_condition</span> <span class="o">=</span> <span class="n">expected_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filter_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">filter_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left_anti&quot;</span><span class="p">)</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">df_filtered_condition</span><span class="p">)</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">df_unfiltered</span><span class="p">)</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>        <span class="k">assert</span> <span class="n">df_unfiltered</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;The filtering condition did not exclude all expected rows.&quot;</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>        <span class="k">assert</span> <span class="n">df_filtered_condition</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;The filtering condition excluded some unexpected rows.&quot;</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">filter_df</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">),</span> <span class="s2">&quot;The filtered DataFrame does not match the expected DataFrame.&quot;</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>    <span class="k">def</span> <span class="nf">write_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a><span class="sd">        Checks if a file exists at the specified path.</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a><span class="sd">        </span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a><span class="sd">        This function splits the file path to get its type, then checks if a file exists at the given location. If the check fails, the function raises an AssertionError.</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a><span class="sd">        </span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a><span class="sd">        Parameters:</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a><span class="sd">        </span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a><span class="sd">            - &#39;file_path&#39; (str): The file path.</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a><span class="sd">                    </span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a><span class="sd">        Returns:</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a><span class="sd">            None. Raises an AssertionError if the file does not exist at the specified path.</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>        
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>        <span class="n">start_path</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>        <span class="n">start_accepted</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;abfss&quot;</span><span class="p">,</span> <span class="s2">&quot;https&quot;</span> <span class="p">,</span> <span class="s2">&quot;adl&quot;</span><span class="p">]</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>        <span class="k">if</span> <span class="n">start_path</span> <span class="ow">in</span> <span class="n">start_accepted</span><span class="p">:</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>                <span class="n">file_list</span> <span class="o">=</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The file does not exist at the specified path : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>            <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="s2">&quot;The file does not exist at the specified path.&quot;</span>
</span></pre></div>


            </section>
                <section id="Utils">
                            <input id="Utils-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Utils</span>:

                <label class="view-source-button" for="Utils-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils-7"><a href="#Utils-7"><span class="linenos">  7</span></a><span class="k">class</span> <span class="nc">Utils</span><span class="p">:</span>
</span><span id="Utils-8"><a href="#Utils-8"><span class="linenos">  8</span></a>
</span><span id="Utils-9"><a href="#Utils-9"><span class="linenos">  9</span></a>    <span class="n">__test__</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="Utils-10"><a href="#Utils-10"><span class="linenos"> 10</span></a>
</span><span id="Utils-11"><a href="#Utils-11"><span class="linenos"> 11</span></a>    <span class="n">storage_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Utils-12"><a href="#Utils-12"><span class="linenos"> 12</span></a>    <span class="n">scope</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Utils-13"><a href="#Utils-13"><span class="linenos"> 13</span></a>    <span class="n">key</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="Utils-14"><a href="#Utils-14"><span class="linenos"> 14</span></a>
</span><span id="Utils-15"><a href="#Utils-15"><span class="linenos"> 15</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Utils-16"><a href="#Utils-16"><span class="linenos"> 16</span></a>
</span><span id="Utils-17"><a href="#Utils-17"><span class="linenos"> 17</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-18"><a href="#Utils-18"><span class="linenos"> 18</span></a><span class="sd">        Initializes the class with the given storage name, scope, and key.</span>
</span><span id="Utils-19"><a href="#Utils-19"><span class="linenos"> 19</span></a><span class="sd">        </span>
</span><span id="Utils-20"><a href="#Utils-20"><span class="linenos"> 20</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-21"><a href="#Utils-21"><span class="linenos"> 21</span></a><span class="sd">            - &#39;storage_name&#39; (str): The name of the storage.</span>
</span><span id="Utils-22"><a href="#Utils-22"><span class="linenos"> 22</span></a><span class="sd">            - &#39;scope&#39; (str, optional): The scope of the storage.</span>
</span><span id="Utils-23"><a href="#Utils-23"><span class="linenos"> 23</span></a><span class="sd">            - &#39;key&#39; (str, optional): The key for the storage.</span>
</span><span id="Utils-24"><a href="#Utils-24"><span class="linenos"> 24</span></a><span class="sd">            </span>
</span><span id="Utils-25"><a href="#Utils-25"><span class="linenos"> 25</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-26"><a href="#Utils-26"><span class="linenos"> 26</span></a><span class="sd">            None.</span>
</span><span id="Utils-27"><a href="#Utils-27"><span class="linenos"> 27</span></a><span class="sd">        &quot;&quot;&quot;</span>   
</span><span id="Utils-28"><a href="#Utils-28"><span class="linenos"> 28</span></a>
</span><span id="Utils-29"><a href="#Utils-29"><span class="linenos"> 29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage_name</span> <span class="o">=</span> <span class="n">storage_name</span>
</span><span id="Utils-30"><a href="#Utils-30"><span class="linenos"> 30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scope</span> <span class="o">=</span> <span class="n">scope</span>
</span><span id="Utils-31"><a href="#Utils-31"><span class="linenos"> 31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
</span><span id="Utils-32"><a href="#Utils-32"><span class="linenos"> 32</span></a>
</span><span id="Utils-33"><a href="#Utils-33"><span class="linenos"> 33</span></a>    <span class="k">def</span> <span class="nf">connect_storage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Utils-34"><a href="#Utils-34"><span class="linenos"> 34</span></a><span class="w">        </span>
</span><span id="Utils-35"><a href="#Utils-35"><span class="linenos"> 35</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-36"><a href="#Utils-36"><span class="linenos"> 36</span></a><span class="sd">        Connects to the storage using the given scope and key.</span>
</span><span id="Utils-37"><a href="#Utils-37"><span class="linenos"> 37</span></a><span class="sd">        </span>
</span><span id="Utils-38"><a href="#Utils-38"><span class="linenos"> 38</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-39"><a href="#Utils-39"><span class="linenos"> 39</span></a><span class="sd">            </span>
</span><span id="Utils-40"><a href="#Utils-40"><span class="linenos"> 40</span></a><span class="sd">            - None.</span>
</span><span id="Utils-41"><a href="#Utils-41"><span class="linenos"> 41</span></a><span class="sd">            </span>
</span><span id="Utils-42"><a href="#Utils-42"><span class="linenos"> 42</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-43"><a href="#Utils-43"><span class="linenos"> 43</span></a><span class="sd">            None. Sets the configuration for the Azure Data Lake Storage Gen2 account.</span>
</span><span id="Utils-44"><a href="#Utils-44"><span class="linenos"> 44</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-45"><a href="#Utils-45"><span class="linenos"> 45</span></a>
</span><span id="Utils-46"><a href="#Utils-46"><span class="linenos"> 46</span></a>        <span class="n">ADLS2AccountKey</span> <span class="o">=</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">secrets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</span><span id="Utils-47"><a href="#Utils-47"><span class="linenos"> 47</span></a>        <span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;fs.azure.account.key.&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_name</span> <span class="o">+</span> <span class="s2">&quot;.dfs.core.windows.net&quot;</span><span class="p">,</span> <span class="n">ADLS2AccountKey</span><span class="p">)</span>
</span><span id="Utils-48"><a href="#Utils-48"><span class="linenos"> 48</span></a>    
</span><span id="Utils-49"><a href="#Utils-49"><span class="linenos"> 49</span></a>    <span class="k">def</span> <span class="nf">new_df</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">new_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">expected_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Utils-50"><a href="#Utils-50"><span class="linenos"> 50</span></a>
</span><span id="Utils-51"><a href="#Utils-51"><span class="linenos"> 51</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-52"><a href="#Utils-52"><span class="linenos"> 52</span></a><span class="sd">        Tests the creation of a new dataframe by comparing the created dataframe and its schema to an expected dataframe and an expected schema.</span>
</span><span id="Utils-53"><a href="#Utils-53"><span class="linenos"> 53</span></a><span class="sd">        </span>
</span><span id="Utils-54"><a href="#Utils-54"><span class="linenos"> 54</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-55"><a href="#Utils-55"><span class="linenos"> 55</span></a><span class="sd">            </span>
</span><span id="Utils-56"><a href="#Utils-56"><span class="linenos"> 56</span></a><span class="sd">            - new_df (DataFrame): The newly created DataFrame. </span>
</span><span id="Utils-57"><a href="#Utils-57"><span class="linenos"> 57</span></a><span class="sd">            </span>
</span><span id="Utils-58"><a href="#Utils-58"><span class="linenos"> 58</span></a><span class="sd">            - expected_df (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="Utils-59"><a href="#Utils-59"><span class="linenos"> 59</span></a>
</span><span id="Utils-60"><a href="#Utils-60"><span class="linenos"> 60</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-61"><a href="#Utils-61"><span class="linenos"> 61</span></a><span class="sd">            None. Raises an AssertionError if the dataframes or schemas do not match.</span>
</span><span id="Utils-62"><a href="#Utils-62"><span class="linenos"> 62</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-63"><a href="#Utils-63"><span class="linenos"> 63</span></a>
</span><span id="Utils-64"><a href="#Utils-64"><span class="linenos"> 64</span></a>
</span><span id="Utils-65"><a href="#Utils-65"><span class="linenos"> 65</span></a>        <span class="n">df_schema</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">schema</span>
</span><span id="Utils-66"><a href="#Utils-66"><span class="linenos"> 66</span></a>        <span class="n">expected_schema</span> <span class="o">=</span> <span class="n">expected_df</span><span class="o">.</span><span class="n">schema</span>
</span><span id="Utils-67"><a href="#Utils-67"><span class="linenos"> 67</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">new_df</span> <span class="p">,</span> <span class="n">expected_df</span><span class="p">),</span> <span class="s2">&quot;The newly created DataFrame does not match the expected DataFrame.&quot;</span>
</span><span id="Utils-68"><a href="#Utils-68"><span class="linenos"> 68</span></a>        <span class="n">assertSchemaEqual</span><span class="p">(</span><span class="n">df_schema</span> <span class="p">,</span> <span class="n">expected_schema</span><span class="p">),</span> <span class="s2">&quot;The schema of the newly created DataFrame does not match the expected schema.&quot;</span>
</span><span id="Utils-69"><a href="#Utils-69"><span class="linenos"> 69</span></a>
</span><span id="Utils-70"><a href="#Utils-70"><span class="linenos"> 70</span></a>    <span class="k">def</span> <span class="nf">new_col</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">new_col</span> <span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">expected_type_new_col</span> <span class="p">:</span> <span class="nb">type</span> <span class="p">,</span> <span class="n">expected_nullable</span> <span class="p">:</span> <span class="nb">bool</span> <span class="p">,</span> <span class="n">initial_df</span> <span class="p">:</span> <span class="n">DataFrame</span> <span class="p">,</span> <span class="n">final_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Utils-71"><a href="#Utils-71"><span class="linenos"> 71</span></a>
</span><span id="Utils-72"><a href="#Utils-72"><span class="linenos"> 72</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-73"><a href="#Utils-73"><span class="linenos"> 73</span></a><span class="sd">        Tests the creation of a new column in a dataframe by comparing the final dataframe to the initial dataframe.</span>
</span><span id="Utils-74"><a href="#Utils-74"><span class="linenos"> 74</span></a><span class="sd">        </span>
</span><span id="Utils-75"><a href="#Utils-75"><span class="linenos"> 75</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-76"><a href="#Utils-76"><span class="linenos"> 76</span></a>
</span><span id="Utils-77"><a href="#Utils-77"><span class="linenos"> 77</span></a><span class="sd">            - &#39;new_col&#39; (str): The name of the newly created column.</span>
</span><span id="Utils-78"><a href="#Utils-78"><span class="linenos"> 78</span></a>
</span><span id="Utils-79"><a href="#Utils-79"><span class="linenos"> 79</span></a><span class="sd">            - &#39;expected_type_new_col&#39; (type): The expected data type of the new column.</span>
</span><span id="Utils-80"><a href="#Utils-80"><span class="linenos"> 80</span></a>
</span><span id="Utils-81"><a href="#Utils-81"><span class="linenos"> 81</span></a><span class="sd">            - &#39;expected_nullable&#39; (bool): The expected nullable property of the new column.</span>
</span><span id="Utils-82"><a href="#Utils-82"><span class="linenos"> 82</span></a>
</span><span id="Utils-83"><a href="#Utils-83"><span class="linenos"> 83</span></a><span class="sd">            - &#39;initial_df&#39; (DataFrame): The initial DataFrame before the new column is added.</span>
</span><span id="Utils-84"><a href="#Utils-84"><span class="linenos"> 84</span></a>
</span><span id="Utils-85"><a href="#Utils-85"><span class="linenos"> 85</span></a><span class="sd">            - &#39;final_df&#39; (DataFrame): The final DataFrame after the new column is added.</span>
</span><span id="Utils-86"><a href="#Utils-86"><span class="linenos"> 86</span></a><span class="sd">            </span>
</span><span id="Utils-87"><a href="#Utils-87"><span class="linenos"> 87</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-88"><a href="#Utils-88"><span class="linenos"> 88</span></a><span class="sd">            None. Raises an AssertionError if the new column or its properties do not match the expectations.</span>
</span><span id="Utils-89"><a href="#Utils-89"><span class="linenos"> 89</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-90"><a href="#Utils-90"><span class="linenos"> 90</span></a>
</span><span id="Utils-91"><a href="#Utils-91"><span class="linenos"> 91</span></a>        <span class="k">assert</span> <span class="n">new_col</span> <span class="ow">in</span> <span class="n">final_df</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span><span class="s2">&quot;The new column does not exist in the final DataFrame.&quot;</span>
</span><span id="Utils-92"><a href="#Utils-92"><span class="linenos"> 92</span></a>        <span class="k">assert</span> <span class="n">new_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">initial_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;The new column already exists in the initial DataFrame.&quot;</span>
</span><span id="Utils-93"><a href="#Utils-93"><span class="linenos"> 93</span></a>        <span class="k">assert</span> <span class="n">final_df</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span><span class="o">.</span><span class="n">dataType</span> <span class="o">==</span> <span class="n">expected_type_new_col</span> <span class="p">,</span> <span class="s2">&quot;The data type of the new column does not match the expected data type.&quot;</span>
</span><span id="Utils-94"><a href="#Utils-94"><span class="linenos"> 94</span></a>        <span class="k">assert</span> <span class="n">final_df</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span><span class="o">.</span><span class="n">nullable</span> <span class="o">==</span> <span class="n">expected_nullable</span> <span class="p">,</span> <span class="s2">&quot;The nullable property of the new column does not match the expected nullable property.&quot;</span>
</span><span id="Utils-95"><a href="#Utils-95"><span class="linenos"> 95</span></a>    
</span><span id="Utils-96"><a href="#Utils-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">renamed_col</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">renamed_df</span> <span class="p">:</span> <span class="n">DataFrame</span> <span class="p">,</span> <span class="n">expected_df</span> <span class="p">:</span> <span class="n">DataFrame</span> <span class="p">):</span>
</span><span id="Utils-97"><a href="#Utils-97"><span class="linenos"> 97</span></a>
</span><span id="Utils-98"><a href="#Utils-98"><span class="linenos"> 98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-99"><a href="#Utils-99"><span class="linenos"> 99</span></a><span class="sd">        Tests the renaming of columns in a dataframe by comparing the renamed dataframe and its schema to an expected dataframe.</span>
</span><span id="Utils-100"><a href="#Utils-100"><span class="linenos">100</span></a><span class="sd">        </span>
</span><span id="Utils-101"><a href="#Utils-101"><span class="linenos">101</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-102"><a href="#Utils-102"><span class="linenos">102</span></a>
</span><span id="Utils-103"><a href="#Utils-103"><span class="linenos">103</span></a><span class="sd">            - &#39;renamed_df&#39; (DataFrame): The DataFrame after the columns have been renamed.</span>
</span><span id="Utils-104"><a href="#Utils-104"><span class="linenos">104</span></a>
</span><span id="Utils-105"><a href="#Utils-105"><span class="linenos">105</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="Utils-106"><a href="#Utils-106"><span class="linenos">106</span></a><span class="sd">            </span>
</span><span id="Utils-107"><a href="#Utils-107"><span class="linenos">107</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-108"><a href="#Utils-108"><span class="linenos">108</span></a><span class="sd">            None. Raises an AssertionError if the dataframes or schemas do not match the expectations.</span>
</span><span id="Utils-109"><a href="#Utils-109"><span class="linenos">109</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-110"><a href="#Utils-110"><span class="linenos">110</span></a>
</span><span id="Utils-111"><a href="#Utils-111"><span class="linenos">111</span></a>        <span class="n">renamed_schema</span> <span class="o">=</span> <span class="n">renamed_df</span><span class="o">.</span><span class="n">schema</span>
</span><span id="Utils-112"><a href="#Utils-112"><span class="linenos">112</span></a>        <span class="n">expected_schema</span> <span class="o">=</span> <span class="n">expected_df</span><span class="o">.</span><span class="n">schema</span>
</span><span id="Utils-113"><a href="#Utils-113"><span class="linenos">113</span></a>
</span><span id="Utils-114"><a href="#Utils-114"><span class="linenos">114</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">renamed_df</span> <span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The DataFrame after renaming columns does not match the expected DataFrame.&quot;</span>
</span><span id="Utils-115"><a href="#Utils-115"><span class="linenos">115</span></a>        <span class="n">assertSchemaEqual</span><span class="p">(</span><span class="n">renamed_schema</span> <span class="p">,</span> <span class="n">expected_schema</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The schema of the DataFrame after renaming columns does not match the expected schema.&quot;</span>
</span><span id="Utils-116"><a href="#Utils-116"><span class="linenos">116</span></a>    
</span><span id="Utils-117"><a href="#Utils-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">dropped_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dropped_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">dropped_col</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Utils-118"><a href="#Utils-118"><span class="linenos">118</span></a><span class="w">            </span>
</span><span id="Utils-119"><a href="#Utils-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-120"><a href="#Utils-120"><span class="linenos">120</span></a><span class="sd">        Tests the dropping of columns in a dataframe by comparing the dataframe after columns have been dropped to an expected dataframe.</span>
</span><span id="Utils-121"><a href="#Utils-121"><span class="linenos">121</span></a><span class="sd">        </span>
</span><span id="Utils-122"><a href="#Utils-122"><span class="linenos">122</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-123"><a href="#Utils-123"><span class="linenos">123</span></a>
</span><span id="Utils-124"><a href="#Utils-124"><span class="linenos">124</span></a><span class="sd">            - &#39;dropped_df&#39; (DataFrame): The DataFrame after the columns have been dropped.</span>
</span><span id="Utils-125"><a href="#Utils-125"><span class="linenos">125</span></a>
</span><span id="Utils-126"><a href="#Utils-126"><span class="linenos">126</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="Utils-127"><a href="#Utils-127"><span class="linenos">127</span></a>
</span><span id="Utils-128"><a href="#Utils-128"><span class="linenos">128</span></a><span class="sd">            - &#39;dropped_col&#39; (list): The list of columns that have been dropped.</span>
</span><span id="Utils-129"><a href="#Utils-129"><span class="linenos">129</span></a><span class="sd">            </span>
</span><span id="Utils-130"><a href="#Utils-130"><span class="linenos">130</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-131"><a href="#Utils-131"><span class="linenos">131</span></a><span class="sd">            None. Raises an AssertionError if the dataframes do not match or if the dropped columns still exist in the dataframe.</span>
</span><span id="Utils-132"><a href="#Utils-132"><span class="linenos">132</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-133"><a href="#Utils-133"><span class="linenos">133</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">dropped_df</span> <span class="p">,</span> <span class="n">expected_df</span><span class="p">),</span>  <span class="s2">&quot;The DataFrame after dropping columns does not match the expected DataFrame.&quot;</span>
</span><span id="Utils-134"><a href="#Utils-134"><span class="linenos">134</span></a>        <span class="k">for</span> <span class="n">colonne</span> <span class="ow">in</span> <span class="n">dropped_col</span><span class="p">:</span>
</span><span id="Utils-135"><a href="#Utils-135"><span class="linenos">135</span></a>            <span class="k">assert</span> <span class="n">colonne</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dropped_df</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The column &#39;</span><span class="si">{</span><span class="n">colonne</span><span class="si">}</span><span class="s2">&#39; was not successfully dropped from the DataFrame.&quot;</span>
</span><span id="Utils-136"><a href="#Utils-136"><span class="linenos">136</span></a>
</span><span id="Utils-137"><a href="#Utils-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">conversion_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">convert_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">convert_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">expected_type</span> <span class="p">:</span> <span class="nb">type</span><span class="p">):</span>
</span><span id="Utils-138"><a href="#Utils-138"><span class="linenos">138</span></a>
</span><span id="Utils-139"><a href="#Utils-139"><span class="linenos">139</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-140"><a href="#Utils-140"><span class="linenos">140</span></a><span class="sd">        Tests the conversion of a column&#39;s data type in a dataframe.</span>
</span><span id="Utils-141"><a href="#Utils-141"><span class="linenos">141</span></a><span class="sd">        </span>
</span><span id="Utils-142"><a href="#Utils-142"><span class="linenos">142</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-143"><a href="#Utils-143"><span class="linenos">143</span></a>
</span><span id="Utils-144"><a href="#Utils-144"><span class="linenos">144</span></a><span class="sd">            - &#39;convert_df&#39; (DataFrame): The DataFrame after the column&#39;s data type has been converted.</span>
</span><span id="Utils-145"><a href="#Utils-145"><span class="linenos">145</span></a>
</span><span id="Utils-146"><a href="#Utils-146"><span class="linenos">146</span></a><span class="sd">            - &#39;convert_col&#39; (str): The name of the column whose data type has been converted.</span>
</span><span id="Utils-147"><a href="#Utils-147"><span class="linenos">147</span></a>
</span><span id="Utils-148"><a href="#Utils-148"><span class="linenos">148</span></a><span class="sd">            - &#39;expected_type&#39; (type): The expected data type of the converted column.</span>
</span><span id="Utils-149"><a href="#Utils-149"><span class="linenos">149</span></a><span class="sd">            </span>
</span><span id="Utils-150"><a href="#Utils-150"><span class="linenos">150</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-151"><a href="#Utils-151"><span class="linenos">151</span></a><span class="sd">            None. Raises an AssertionError if the data type of the converted column does not match the expected data type.</span>
</span><span id="Utils-152"><a href="#Utils-152"><span class="linenos">152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-153"><a href="#Utils-153"><span class="linenos">153</span></a>        <span class="k">assert</span> <span class="n">convert_df</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">convert_col</span><span class="p">]</span><span class="o">.</span><span class="n">dataType</span> <span class="o">==</span> <span class="n">expected_type</span> <span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The data type of column &#39;</span><span class="si">{</span><span class="n">convert_col</span><span class="si">}</span><span class="s2">&#39; does not match the expected type (</span><span class="si">{</span><span class="n">expected_type</span><span class="si">}</span><span class="s2">).&quot;</span>
</span><span id="Utils-154"><a href="#Utils-154"><span class="linenos">154</span></a>
</span><span id="Utils-155"><a href="#Utils-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">csv_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils-156"><a href="#Utils-156"><span class="linenos">156</span></a>
</span><span id="Utils-157"><a href="#Utils-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-158"><a href="#Utils-158"><span class="linenos">158</span></a><span class="sd">        Converts a CSV file to a DataFrame.</span>
</span><span id="Utils-159"><a href="#Utils-159"><span class="linenos">159</span></a><span class="sd">        </span>
</span><span id="Utils-160"><a href="#Utils-160"><span class="linenos">160</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-161"><a href="#Utils-161"><span class="linenos">161</span></a>
</span><span id="Utils-162"><a href="#Utils-162"><span class="linenos">162</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the CSV file.</span>
</span><span id="Utils-163"><a href="#Utils-163"><span class="linenos">163</span></a>
</span><span id="Utils-164"><a href="#Utils-164"><span class="linenos">164</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;csv&#39;.</span>
</span><span id="Utils-165"><a href="#Utils-165"><span class="linenos">165</span></a>
</span><span id="Utils-166"><a href="#Utils-166"><span class="linenos">166</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="Utils-167"><a href="#Utils-167"><span class="linenos">167</span></a><span class="sd">                    </span>
</span><span id="Utils-168"><a href="#Utils-168"><span class="linenos">168</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-169"><a href="#Utils-169"><span class="linenos">169</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the CSV file.</span>
</span><span id="Utils-170"><a href="#Utils-170"><span class="linenos">170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-171"><a href="#Utils-171"><span class="linenos">171</span></a>
</span><span id="Utils-172"><a href="#Utils-172"><span class="linenos">172</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils-173"><a href="#Utils-173"><span class="linenos">173</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;csv&quot;</span><span class="p">:</span>
</span><span id="Utils-174"><a href="#Utils-174"><span class="linenos">174</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils-175"><a href="#Utils-175"><span class="linenos">175</span></a>            
</span><span id="Utils-176"><a href="#Utils-176"><span class="linenos">176</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils-177"><a href="#Utils-177"><span class="linenos">177</span></a>            
</span><span id="Utils-178"><a href="#Utils-178"><span class="linenos">178</span></a>            <span class="k">return</span> <span class="n">expected_df</span>
</span><span id="Utils-179"><a href="#Utils-179"><span class="linenos">179</span></a>        
</span><span id="Utils-180"><a href="#Utils-180"><span class="linenos">180</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils-181"><a href="#Utils-181"><span class="linenos">181</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Utils-182"><a href="#Utils-182"><span class="linenos">182</span></a>    
</span><span id="Utils-183"><a href="#Utils-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">xlsx_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils-184"><a href="#Utils-184"><span class="linenos">184</span></a>
</span><span id="Utils-185"><a href="#Utils-185"><span class="linenos">185</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-186"><a href="#Utils-186"><span class="linenos">186</span></a><span class="sd">        Converts an XLSX file to a DataFrame.</span>
</span><span id="Utils-187"><a href="#Utils-187"><span class="linenos">187</span></a><span class="sd">        </span>
</span><span id="Utils-188"><a href="#Utils-188"><span class="linenos">188</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-189"><a href="#Utils-189"><span class="linenos">189</span></a>
</span><span id="Utils-190"><a href="#Utils-190"><span class="linenos">190</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the XLSX file.</span>
</span><span id="Utils-191"><a href="#Utils-191"><span class="linenos">191</span></a>
</span><span id="Utils-192"><a href="#Utils-192"><span class="linenos">192</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;xlsx&#39;.</span>
</span><span id="Utils-193"><a href="#Utils-193"><span class="linenos">193</span></a>
</span><span id="Utils-194"><a href="#Utils-194"><span class="linenos">194</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.           </span>
</span><span id="Utils-195"><a href="#Utils-195"><span class="linenos">195</span></a><span class="sd">            </span>
</span><span id="Utils-196"><a href="#Utils-196"><span class="linenos">196</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-197"><a href="#Utils-197"><span class="linenos">197</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the XLSX file.</span>
</span><span id="Utils-198"><a href="#Utils-198"><span class="linenos">198</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-199"><a href="#Utils-199"><span class="linenos">199</span></a>
</span><span id="Utils-200"><a href="#Utils-200"><span class="linenos">200</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils-201"><a href="#Utils-201"><span class="linenos">201</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">:</span>
</span><span id="Utils-202"><a href="#Utils-202"><span class="linenos">202</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils-203"><a href="#Utils-203"><span class="linenos">203</span></a>            
</span><span id="Utils-204"><a href="#Utils-204"><span class="linenos">204</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils-205"><a href="#Utils-205"><span class="linenos">205</span></a>            <span class="k">return</span> <span class="n">expected_df</span> 
</span><span id="Utils-206"><a href="#Utils-206"><span class="linenos">206</span></a>         
</span><span id="Utils-207"><a href="#Utils-207"><span class="linenos">207</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils-208"><a href="#Utils-208"><span class="linenos">208</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Utils-209"><a href="#Utils-209"><span class="linenos">209</span></a>
</span><span id="Utils-210"><a href="#Utils-210"><span class="linenos">210</span></a>    <span class="k">def</span> <span class="nf">txt_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span> 
</span><span id="Utils-211"><a href="#Utils-211"><span class="linenos">211</span></a>
</span><span id="Utils-212"><a href="#Utils-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-213"><a href="#Utils-213"><span class="linenos">213</span></a><span class="sd">        Converts a TXT file to a DataFrame.</span>
</span><span id="Utils-214"><a href="#Utils-214"><span class="linenos">214</span></a><span class="sd">        </span>
</span><span id="Utils-215"><a href="#Utils-215"><span class="linenos">215</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-216"><a href="#Utils-216"><span class="linenos">216</span></a>
</span><span id="Utils-217"><a href="#Utils-217"><span class="linenos">217</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the TXT file.</span>
</span><span id="Utils-218"><a href="#Utils-218"><span class="linenos">218</span></a>
</span><span id="Utils-219"><a href="#Utils-219"><span class="linenos">219</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;txt&#39;.</span>
</span><span id="Utils-220"><a href="#Utils-220"><span class="linenos">220</span></a>
</span><span id="Utils-221"><a href="#Utils-221"><span class="linenos">221</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.            </span>
</span><span id="Utils-222"><a href="#Utils-222"><span class="linenos">222</span></a><span class="sd">            </span>
</span><span id="Utils-223"><a href="#Utils-223"><span class="linenos">223</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-224"><a href="#Utils-224"><span class="linenos">224</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the TXT file.</span>
</span><span id="Utils-225"><a href="#Utils-225"><span class="linenos">225</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-226"><a href="#Utils-226"><span class="linenos">226</span></a>        
</span><span id="Utils-227"><a href="#Utils-227"><span class="linenos">227</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils-228"><a href="#Utils-228"><span class="linenos">228</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;txt&quot;</span> <span class="p">:</span>
</span><span id="Utils-229"><a href="#Utils-229"><span class="linenos">229</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>           
</span><span id="Utils-230"><a href="#Utils-230"><span class="linenos">230</span></a>            
</span><span id="Utils-231"><a href="#Utils-231"><span class="linenos">231</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils-232"><a href="#Utils-232"><span class="linenos">232</span></a>            <span class="k">return</span> <span class="n">expected_df</span> 
</span><span id="Utils-233"><a href="#Utils-233"><span class="linenos">233</span></a>        
</span><span id="Utils-234"><a href="#Utils-234"><span class="linenos">234</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils-235"><a href="#Utils-235"><span class="linenos">235</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Utils-236"><a href="#Utils-236"><span class="linenos">236</span></a>
</span><span id="Utils-237"><a href="#Utils-237"><span class="linenos">237</span></a>    <span class="k">def</span> <span class="nf">json_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span> 
</span><span id="Utils-238"><a href="#Utils-238"><span class="linenos">238</span></a><span class="w">        </span>
</span><span id="Utils-239"><a href="#Utils-239"><span class="linenos">239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-240"><a href="#Utils-240"><span class="linenos">240</span></a><span class="sd">        Converts a JSON file to a DataFrame.</span>
</span><span id="Utils-241"><a href="#Utils-241"><span class="linenos">241</span></a><span class="sd">        </span>
</span><span id="Utils-242"><a href="#Utils-242"><span class="linenos">242</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-243"><a href="#Utils-243"><span class="linenos">243</span></a>
</span><span id="Utils-244"><a href="#Utils-244"><span class="linenos">244</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the JSON file.</span>
</span><span id="Utils-245"><a href="#Utils-245"><span class="linenos">245</span></a>
</span><span id="Utils-246"><a href="#Utils-246"><span class="linenos">246</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;json&#39;.</span>
</span><span id="Utils-247"><a href="#Utils-247"><span class="linenos">247</span></a>
</span><span id="Utils-248"><a href="#Utils-248"><span class="linenos">248</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.           </span>
</span><span id="Utils-249"><a href="#Utils-249"><span class="linenos">249</span></a><span class="sd">            </span>
</span><span id="Utils-250"><a href="#Utils-250"><span class="linenos">250</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-251"><a href="#Utils-251"><span class="linenos">251</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the JSON file.</span>
</span><span id="Utils-252"><a href="#Utils-252"><span class="linenos">252</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-253"><a href="#Utils-253"><span class="linenos">253</span></a>
</span><span id="Utils-254"><a href="#Utils-254"><span class="linenos">254</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils-255"><a href="#Utils-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;json&quot;</span> <span class="p">:</span>
</span><span id="Utils-256"><a href="#Utils-256"><span class="linenos">256</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils-257"><a href="#Utils-257"><span class="linenos">257</span></a>
</span><span id="Utils-258"><a href="#Utils-258"><span class="linenos">258</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;json&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> 
</span><span id="Utils-259"><a href="#Utils-259"><span class="linenos">259</span></a>            <span class="k">return</span> <span class="n">expected_df</span>  
</span><span id="Utils-260"><a href="#Utils-260"><span class="linenos">260</span></a>        
</span><span id="Utils-261"><a href="#Utils-261"><span class="linenos">261</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils-262"><a href="#Utils-262"><span class="linenos">262</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Utils-263"><a href="#Utils-263"><span class="linenos">263</span></a>
</span><span id="Utils-264"><a href="#Utils-264"><span class="linenos">264</span></a>    <span class="k">def</span> <span class="nf">parquet_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils-265"><a href="#Utils-265"><span class="linenos">265</span></a><span class="w">        </span>
</span><span id="Utils-266"><a href="#Utils-266"><span class="linenos">266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-267"><a href="#Utils-267"><span class="linenos">267</span></a><span class="sd">        Converts a Parquet file to a DataFrame.</span>
</span><span id="Utils-268"><a href="#Utils-268"><span class="linenos">268</span></a><span class="sd">        </span>
</span><span id="Utils-269"><a href="#Utils-269"><span class="linenos">269</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-270"><a href="#Utils-270"><span class="linenos">270</span></a>
</span><span id="Utils-271"><a href="#Utils-271"><span class="linenos">271</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the Parquet file.</span>
</span><span id="Utils-272"><a href="#Utils-272"><span class="linenos">272</span></a>
</span><span id="Utils-273"><a href="#Utils-273"><span class="linenos">273</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;parquet&#39;.</span>
</span><span id="Utils-274"><a href="#Utils-274"><span class="linenos">274</span></a>
</span><span id="Utils-275"><a href="#Utils-275"><span class="linenos">275</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.           </span>
</span><span id="Utils-276"><a href="#Utils-276"><span class="linenos">276</span></a><span class="sd">            </span>
</span><span id="Utils-277"><a href="#Utils-277"><span class="linenos">277</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-278"><a href="#Utils-278"><span class="linenos">278</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the Parquet file.</span>
</span><span id="Utils-279"><a href="#Utils-279"><span class="linenos">279</span></a><span class="sd">        &quot;&quot;&quot;</span>    
</span><span id="Utils-280"><a href="#Utils-280"><span class="linenos">280</span></a>
</span><span id="Utils-281"><a href="#Utils-281"><span class="linenos">281</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils-282"><a href="#Utils-282"><span class="linenos">282</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;parquet&quot;</span> <span class="p">:</span>
</span><span id="Utils-283"><a href="#Utils-283"><span class="linenos">283</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils-284"><a href="#Utils-284"><span class="linenos">284</span></a>
</span><span id="Utils-285"><a href="#Utils-285"><span class="linenos">285</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;parquet&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> 
</span><span id="Utils-286"><a href="#Utils-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="n">expected_df</span>  
</span><span id="Utils-287"><a href="#Utils-287"><span class="linenos">287</span></a>        
</span><span id="Utils-288"><a href="#Utils-288"><span class="linenos">288</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils-289"><a href="#Utils-289"><span class="linenos">289</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Utils-290"><a href="#Utils-290"><span class="linenos">290</span></a>
</span><span id="Utils-291"><a href="#Utils-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">function_df_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Utils-292"><a href="#Utils-292"><span class="linenos">292</span></a>
</span><span id="Utils-293"><a href="#Utils-293"><span class="linenos">293</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-294"><a href="#Utils-294"><span class="linenos">294</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame.</span>
</span><span id="Utils-295"><a href="#Utils-295"><span class="linenos">295</span></a><span class="sd">        </span>
</span><span id="Utils-296"><a href="#Utils-296"><span class="linenos">296</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-297"><a href="#Utils-297"><span class="linenos">297</span></a>
</span><span id="Utils-298"><a href="#Utils-298"><span class="linenos">298</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="Utils-299"><a href="#Utils-299"><span class="linenos">299</span></a>
</span><span id="Utils-300"><a href="#Utils-300"><span class="linenos">300</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="Utils-301"><a href="#Utils-301"><span class="linenos">301</span></a>
</span><span id="Utils-302"><a href="#Utils-302"><span class="linenos">302</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="Utils-303"><a href="#Utils-303"><span class="linenos">303</span></a><span class="sd">            </span>
</span><span id="Utils-304"><a href="#Utils-304"><span class="linenos">304</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-305"><a href="#Utils-305"><span class="linenos">305</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="Utils-306"><a href="#Utils-306"><span class="linenos">306</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-307"><a href="#Utils-307"><span class="linenos">307</span></a>
</span><span id="Utils-308"><a href="#Utils-308"><span class="linenos">308</span></a>        <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="Utils-309"><a href="#Utils-309"><span class="linenos">309</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">expected_df</span><span class="p">,</span> <span class="n">df_result</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span><span id="Utils-310"><a href="#Utils-310"><span class="linenos">310</span></a>
</span><span id="Utils-311"><a href="#Utils-311"><span class="linenos">311</span></a>    <span class="k">def</span> <span class="nf">file_result_df_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils-312"><a href="#Utils-312"><span class="linenos">312</span></a>
</span><span id="Utils-313"><a href="#Utils-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-314"><a href="#Utils-314"><span class="linenos">314</span></a><span class="sd">        Reads a DataFrame from a specified file path using the given file type and options.</span>
</span><span id="Utils-315"><a href="#Utils-315"><span class="linenos">315</span></a><span class="sd">        Compares the resulting DataFrame with an expected DataFrame for equality.</span>
</span><span id="Utils-316"><a href="#Utils-316"><span class="linenos">316</span></a><span class="sd">        </span>
</span><span id="Utils-317"><a href="#Utils-317"><span class="linenos">317</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-318"><a href="#Utils-318"><span class="linenos">318</span></a>
</span><span id="Utils-319"><a href="#Utils-319"><span class="linenos">319</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="Utils-320"><a href="#Utils-320"><span class="linenos">320</span></a>
</span><span id="Utils-321"><a href="#Utils-321"><span class="linenos">321</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file to be read.</span>
</span><span id="Utils-322"><a href="#Utils-322"><span class="linenos">322</span></a>
</span><span id="Utils-323"><a href="#Utils-323"><span class="linenos">323</span></a><span class="sd">            - &#39;file_type&#39; (str): The format of the file (e.g., &#39;parquet&#39;, &#39;csv&#39;, etc.).</span>
</span><span id="Utils-324"><a href="#Utils-324"><span class="linenos">324</span></a>
</span><span id="Utils-325"><a href="#Utils-325"><span class="linenos">325</span></a><span class="sd">            - &#39;options&#39; (dict, optional): Additional options for reading the file (default: {}).</span>
</span><span id="Utils-326"><a href="#Utils-326"><span class="linenos">326</span></a><span class="sd">            </span>
</span><span id="Utils-327"><a href="#Utils-327"><span class="linenos">327</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-328"><a href="#Utils-328"><span class="linenos">328</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame read from the file does not match the expected DataFrame.</span>
</span><span id="Utils-329"><a href="#Utils-329"><span class="linenos">329</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-330"><a href="#Utils-330"><span class="linenos">330</span></a>
</span><span id="Utils-331"><a href="#Utils-331"><span class="linenos">331</span></a>        <span class="n">df_result</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_type</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils-332"><a href="#Utils-332"><span class="linenos">332</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">expected_df</span><span class="p">,</span> <span class="n">df_result</span><span class="p">),</span> <span class="s2">&quot;The output DataFrame does not match the expected DataFrame.&quot;</span>
</span><span id="Utils-333"><a href="#Utils-333"><span class="linenos">333</span></a>
</span><span id="Utils-334"><a href="#Utils-334"><span class="linenos">334</span></a>
</span><span id="Utils-335"><a href="#Utils-335"><span class="linenos">335</span></a>    <span class="k">def</span> <span class="nf">function_csv_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils-336"><a href="#Utils-336"><span class="linenos">336</span></a>
</span><span id="Utils-337"><a href="#Utils-337"><span class="linenos">337</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-338"><a href="#Utils-338"><span class="linenos">338</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a CSV file.</span>
</span><span id="Utils-339"><a href="#Utils-339"><span class="linenos">339</span></a><span class="sd">        </span>
</span><span id="Utils-340"><a href="#Utils-340"><span class="linenos">340</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-341"><a href="#Utils-341"><span class="linenos">341</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="Utils-342"><a href="#Utils-342"><span class="linenos">342</span></a>
</span><span id="Utils-343"><a href="#Utils-343"><span class="linenos">343</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="Utils-344"><a href="#Utils-344"><span class="linenos">344</span></a>
</span><span id="Utils-345"><a href="#Utils-345"><span class="linenos">345</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="Utils-346"><a href="#Utils-346"><span class="linenos">346</span></a>
</span><span id="Utils-347"><a href="#Utils-347"><span class="linenos">347</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;csv&#39;.</span>
</span><span id="Utils-348"><a href="#Utils-348"><span class="linenos">348</span></a>
</span><span id="Utils-349"><a href="#Utils-349"><span class="linenos">349</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="Utils-350"><a href="#Utils-350"><span class="linenos">350</span></a><span class="sd">            </span>
</span><span id="Utils-351"><a href="#Utils-351"><span class="linenos">351</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-352"><a href="#Utils-352"><span class="linenos">352</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="Utils-353"><a href="#Utils-353"><span class="linenos">353</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-354"><a href="#Utils-354"><span class="linenos">354</span></a>
</span><span id="Utils-355"><a href="#Utils-355"><span class="linenos">355</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils-356"><a href="#Utils-356"><span class="linenos">356</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;csv&quot;</span><span class="p">:</span>
</span><span id="Utils-357"><a href="#Utils-357"><span class="linenos">357</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils-358"><a href="#Utils-358"><span class="linenos">358</span></a>
</span><span id="Utils-359"><a href="#Utils-359"><span class="linenos">359</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils-360"><a href="#Utils-360"><span class="linenos">360</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="Utils-361"><a href="#Utils-361"><span class="linenos">361</span></a>        
</span><span id="Utils-362"><a href="#Utils-362"><span class="linenos">362</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils-363"><a href="#Utils-363"><span class="linenos">363</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Utils-364"><a href="#Utils-364"><span class="linenos">364</span></a>        
</span><span id="Utils-365"><a href="#Utils-365"><span class="linenos">365</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span><span id="Utils-366"><a href="#Utils-366"><span class="linenos">366</span></a>    
</span><span id="Utils-367"><a href="#Utils-367"><span class="linenos">367</span></a>    <span class="k">def</span> <span class="nf">function_txt_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils-368"><a href="#Utils-368"><span class="linenos">368</span></a>
</span><span id="Utils-369"><a href="#Utils-369"><span class="linenos">369</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-370"><a href="#Utils-370"><span class="linenos">370</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a TXT file.</span>
</span><span id="Utils-371"><a href="#Utils-371"><span class="linenos">371</span></a><span class="sd">        </span>
</span><span id="Utils-372"><a href="#Utils-372"><span class="linenos">372</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-373"><a href="#Utils-373"><span class="linenos">373</span></a>
</span><span id="Utils-374"><a href="#Utils-374"><span class="linenos">374</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="Utils-375"><a href="#Utils-375"><span class="linenos">375</span></a>
</span><span id="Utils-376"><a href="#Utils-376"><span class="linenos">376</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="Utils-377"><a href="#Utils-377"><span class="linenos">377</span></a>
</span><span id="Utils-378"><a href="#Utils-378"><span class="linenos">378</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="Utils-379"><a href="#Utils-379"><span class="linenos">379</span></a>
</span><span id="Utils-380"><a href="#Utils-380"><span class="linenos">380</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;txt&#39;.</span>
</span><span id="Utils-381"><a href="#Utils-381"><span class="linenos">381</span></a>
</span><span id="Utils-382"><a href="#Utils-382"><span class="linenos">382</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="Utils-383"><a href="#Utils-383"><span class="linenos">383</span></a>
</span><span id="Utils-384"><a href="#Utils-384"><span class="linenos">384</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-385"><a href="#Utils-385"><span class="linenos">385</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="Utils-386"><a href="#Utils-386"><span class="linenos">386</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-387"><a href="#Utils-387"><span class="linenos">387</span></a>
</span><span id="Utils-388"><a href="#Utils-388"><span class="linenos">388</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils-389"><a href="#Utils-389"><span class="linenos">389</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;txt&quot;</span><span class="p">:</span>
</span><span id="Utils-390"><a href="#Utils-390"><span class="linenos">390</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils-391"><a href="#Utils-391"><span class="linenos">391</span></a>
</span><span id="Utils-392"><a href="#Utils-392"><span class="linenos">392</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils-393"><a href="#Utils-393"><span class="linenos">393</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="Utils-394"><a href="#Utils-394"><span class="linenos">394</span></a>
</span><span id="Utils-395"><a href="#Utils-395"><span class="linenos">395</span></a>
</span><span id="Utils-396"><a href="#Utils-396"><span class="linenos">396</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils-397"><a href="#Utils-397"><span class="linenos">397</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Utils-398"><a href="#Utils-398"><span class="linenos">398</span></a>
</span><span id="Utils-399"><a href="#Utils-399"><span class="linenos">399</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span><span id="Utils-400"><a href="#Utils-400"><span class="linenos">400</span></a>
</span><span id="Utils-401"><a href="#Utils-401"><span class="linenos">401</span></a>    <span class="k">def</span> <span class="nf">function_xlsx_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils-402"><a href="#Utils-402"><span class="linenos">402</span></a>
</span><span id="Utils-403"><a href="#Utils-403"><span class="linenos">403</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-404"><a href="#Utils-404"><span class="linenos">404</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from an XLSX file.</span>
</span><span id="Utils-405"><a href="#Utils-405"><span class="linenos">405</span></a><span class="sd">        </span>
</span><span id="Utils-406"><a href="#Utils-406"><span class="linenos">406</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-407"><a href="#Utils-407"><span class="linenos">407</span></a>
</span><span id="Utils-408"><a href="#Utils-408"><span class="linenos">408</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="Utils-409"><a href="#Utils-409"><span class="linenos">409</span></a>
</span><span id="Utils-410"><a href="#Utils-410"><span class="linenos">410</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="Utils-411"><a href="#Utils-411"><span class="linenos">411</span></a>
</span><span id="Utils-412"><a href="#Utils-412"><span class="linenos">412</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="Utils-413"><a href="#Utils-413"><span class="linenos">413</span></a>
</span><span id="Utils-414"><a href="#Utils-414"><span class="linenos">414</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;xlsx&#39;.</span>
</span><span id="Utils-415"><a href="#Utils-415"><span class="linenos">415</span></a>
</span><span id="Utils-416"><a href="#Utils-416"><span class="linenos">416</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="Utils-417"><a href="#Utils-417"><span class="linenos">417</span></a><span class="sd">        </span>
</span><span id="Utils-418"><a href="#Utils-418"><span class="linenos">418</span></a><span class="sd">            </span>
</span><span id="Utils-419"><a href="#Utils-419"><span class="linenos">419</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-420"><a href="#Utils-420"><span class="linenos">420</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="Utils-421"><a href="#Utils-421"><span class="linenos">421</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-422"><a href="#Utils-422"><span class="linenos">422</span></a>
</span><span id="Utils-423"><a href="#Utils-423"><span class="linenos">423</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils-424"><a href="#Utils-424"><span class="linenos">424</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;xlsx&quot;</span><span class="p">:</span>
</span><span id="Utils-425"><a href="#Utils-425"><span class="linenos">425</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils-426"><a href="#Utils-426"><span class="linenos">426</span></a>
</span><span id="Utils-427"><a href="#Utils-427"><span class="linenos">427</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils-428"><a href="#Utils-428"><span class="linenos">428</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="Utils-429"><a href="#Utils-429"><span class="linenos">429</span></a>
</span><span id="Utils-430"><a href="#Utils-430"><span class="linenos">430</span></a>            <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">expected_df</span><span class="p">,</span> <span class="n">df_result</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span><span id="Utils-431"><a href="#Utils-431"><span class="linenos">431</span></a>
</span><span id="Utils-432"><a href="#Utils-432"><span class="linenos">432</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils-433"><a href="#Utils-433"><span class="linenos">433</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>    
</span><span id="Utils-434"><a href="#Utils-434"><span class="linenos">434</span></a>
</span><span id="Utils-435"><a href="#Utils-435"><span class="linenos">435</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span> 
</span><span id="Utils-436"><a href="#Utils-436"><span class="linenos">436</span></a>
</span><span id="Utils-437"><a href="#Utils-437"><span class="linenos">437</span></a>
</span><span id="Utils-438"><a href="#Utils-438"><span class="linenos">438</span></a>    <span class="k">def</span> <span class="nf">function_json_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils-439"><a href="#Utils-439"><span class="linenos">439</span></a>
</span><span id="Utils-440"><a href="#Utils-440"><span class="linenos">440</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-441"><a href="#Utils-441"><span class="linenos">441</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a JSON file.</span>
</span><span id="Utils-442"><a href="#Utils-442"><span class="linenos">442</span></a><span class="sd">        </span>
</span><span id="Utils-443"><a href="#Utils-443"><span class="linenos">443</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-444"><a href="#Utils-444"><span class="linenos">444</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="Utils-445"><a href="#Utils-445"><span class="linenos">445</span></a>
</span><span id="Utils-446"><a href="#Utils-446"><span class="linenos">446</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="Utils-447"><a href="#Utils-447"><span class="linenos">447</span></a>
</span><span id="Utils-448"><a href="#Utils-448"><span class="linenos">448</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="Utils-449"><a href="#Utils-449"><span class="linenos">449</span></a>
</span><span id="Utils-450"><a href="#Utils-450"><span class="linenos">450</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;json&#39;.</span>
</span><span id="Utils-451"><a href="#Utils-451"><span class="linenos">451</span></a>
</span><span id="Utils-452"><a href="#Utils-452"><span class="linenos">452</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="Utils-453"><a href="#Utils-453"><span class="linenos">453</span></a>
</span><span id="Utils-454"><a href="#Utils-454"><span class="linenos">454</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-455"><a href="#Utils-455"><span class="linenos">455</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="Utils-456"><a href="#Utils-456"><span class="linenos">456</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-457"><a href="#Utils-457"><span class="linenos">457</span></a>
</span><span id="Utils-458"><a href="#Utils-458"><span class="linenos">458</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils-459"><a href="#Utils-459"><span class="linenos">459</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;json&quot;</span><span class="p">:</span>
</span><span id="Utils-460"><a href="#Utils-460"><span class="linenos">460</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils-461"><a href="#Utils-461"><span class="linenos">461</span></a>
</span><span id="Utils-462"><a href="#Utils-462"><span class="linenos">462</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils-463"><a href="#Utils-463"><span class="linenos">463</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="Utils-464"><a href="#Utils-464"><span class="linenos">464</span></a>
</span><span id="Utils-465"><a href="#Utils-465"><span class="linenos">465</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils-466"><a href="#Utils-466"><span class="linenos">466</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  
</span><span id="Utils-467"><a href="#Utils-467"><span class="linenos">467</span></a>
</span><span id="Utils-468"><a href="#Utils-468"><span class="linenos">468</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span><span id="Utils-469"><a href="#Utils-469"><span class="linenos">469</span></a>
</span><span id="Utils-470"><a href="#Utils-470"><span class="linenos">470</span></a>    <span class="k">def</span> <span class="nf">function_parquet_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span> <span class="p">):</span>
</span><span id="Utils-471"><a href="#Utils-471"><span class="linenos">471</span></a><span class="w">        </span>
</span><span id="Utils-472"><a href="#Utils-472"><span class="linenos">472</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-473"><a href="#Utils-473"><span class="linenos">473</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a Parquet file.</span>
</span><span id="Utils-474"><a href="#Utils-474"><span class="linenos">474</span></a><span class="sd">        </span>
</span><span id="Utils-475"><a href="#Utils-475"><span class="linenos">475</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-476"><a href="#Utils-476"><span class="linenos">476</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="Utils-477"><a href="#Utils-477"><span class="linenos">477</span></a>
</span><span id="Utils-478"><a href="#Utils-478"><span class="linenos">478</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="Utils-479"><a href="#Utils-479"><span class="linenos">479</span></a>
</span><span id="Utils-480"><a href="#Utils-480"><span class="linenos">480</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="Utils-481"><a href="#Utils-481"><span class="linenos">481</span></a>
</span><span id="Utils-482"><a href="#Utils-482"><span class="linenos">482</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;parquet&#39;.</span>
</span><span id="Utils-483"><a href="#Utils-483"><span class="linenos">483</span></a>
</span><span id="Utils-484"><a href="#Utils-484"><span class="linenos">484</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="Utils-485"><a href="#Utils-485"><span class="linenos">485</span></a>
</span><span id="Utils-486"><a href="#Utils-486"><span class="linenos">486</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-487"><a href="#Utils-487"><span class="linenos">487</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="Utils-488"><a href="#Utils-488"><span class="linenos">488</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-489"><a href="#Utils-489"><span class="linenos">489</span></a>
</span><span id="Utils-490"><a href="#Utils-490"><span class="linenos">490</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils-491"><a href="#Utils-491"><span class="linenos">491</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">:</span>
</span><span id="Utils-492"><a href="#Utils-492"><span class="linenos">492</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils-493"><a href="#Utils-493"><span class="linenos">493</span></a>
</span><span id="Utils-494"><a href="#Utils-494"><span class="linenos">494</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;parquet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils-495"><a href="#Utils-495"><span class="linenos">495</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="Utils-496"><a href="#Utils-496"><span class="linenos">496</span></a>
</span><span id="Utils-497"><a href="#Utils-497"><span class="linenos">497</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils-498"><a href="#Utils-498"><span class="linenos">498</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>       
</span><span id="Utils-499"><a href="#Utils-499"><span class="linenos">499</span></a>
</span><span id="Utils-500"><a href="#Utils-500"><span class="linenos">500</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span> 
</span><span id="Utils-501"><a href="#Utils-501"><span class="linenos">501</span></a>
</span><span id="Utils-502"><a href="#Utils-502"><span class="linenos">502</span></a>        
</span><span id="Utils-503"><a href="#Utils-503"><span class="linenos">503</span></a>    <span class="k">def</span> <span class="nf">duplicates_df</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">df_to_test</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Utils-504"><a href="#Utils-504"><span class="linenos">504</span></a>
</span><span id="Utils-505"><a href="#Utils-505"><span class="linenos">505</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-506"><a href="#Utils-506"><span class="linenos">506</span></a><span class="sd">        Checks if a DataFrame has duplicate rows.</span>
</span><span id="Utils-507"><a href="#Utils-507"><span class="linenos">507</span></a><span class="sd">        </span>
</span><span id="Utils-508"><a href="#Utils-508"><span class="linenos">508</span></a><span class="sd">        This function counts the total number of rows and the number of distinct rows in the DataFrame. </span>
</span><span id="Utils-509"><a href="#Utils-509"><span class="linenos">509</span></a><span class="sd">        If the two counts are not equal, it means there are duplicate rows in the DataFrame, and the function raises an AssertionError.</span>
</span><span id="Utils-510"><a href="#Utils-510"><span class="linenos">510</span></a><span class="sd">        </span>
</span><span id="Utils-511"><a href="#Utils-511"><span class="linenos">511</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-512"><a href="#Utils-512"><span class="linenos">512</span></a>
</span><span id="Utils-513"><a href="#Utils-513"><span class="linenos">513</span></a><span class="sd">            - &#39;df_to_test&#39; (DataFrame): The DataFrame to be checked for duplicates.</span>
</span><span id="Utils-514"><a href="#Utils-514"><span class="linenos">514</span></a><span class="sd">            </span>
</span><span id="Utils-515"><a href="#Utils-515"><span class="linenos">515</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-516"><a href="#Utils-516"><span class="linenos">516</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame has duplicate values.</span>
</span><span id="Utils-517"><a href="#Utils-517"><span class="linenos">517</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-518"><a href="#Utils-518"><span class="linenos">518</span></a>
</span><span id="Utils-519"><a href="#Utils-519"><span class="linenos">519</span></a>        <span class="n">duplicate_df</span> <span class="o">=</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="n">df_to_test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;count &gt; 1&quot;</span><span class="p">)</span>
</span><span id="Utils-520"><a href="#Utils-520"><span class="linenos">520</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">duplicate_df</span><span class="p">)</span>
</span><span id="Utils-521"><a href="#Utils-521"><span class="linenos">521</span></a>        <span class="k">assert</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="p">,</span> <span class="s2">&quot;There are duplicate entries in the DataFrame.&quot;</span> 
</span><span id="Utils-522"><a href="#Utils-522"><span class="linenos">522</span></a>
</span><span id="Utils-523"><a href="#Utils-523"><span class="linenos">523</span></a>
</span><span id="Utils-524"><a href="#Utils-524"><span class="linenos">524</span></a>    <span class="k">def</span> <span class="nf">duplicates_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_to_test</span> <span class="p">:</span> <span class="n">DataFrame</span> <span class="p">,</span> <span class="n">col_name</span> <span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Utils-525"><a href="#Utils-525"><span class="linenos">525</span></a>
</span><span id="Utils-526"><a href="#Utils-526"><span class="linenos">526</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-527"><a href="#Utils-527"><span class="linenos">527</span></a><span class="sd">        Checks if a column in a DataFrame has duplicate values.</span>
</span><span id="Utils-528"><a href="#Utils-528"><span class="linenos">528</span></a><span class="sd">        </span>
</span><span id="Utils-529"><a href="#Utils-529"><span class="linenos">529</span></a><span class="sd">        This function counts the total number of values and the number of distinct values in the specified column of the DataFrame. </span>
</span><span id="Utils-530"><a href="#Utils-530"><span class="linenos">530</span></a><span class="sd">        If the two counts are not equal, it means there are duplicate values in the column, and the function raises an AssertionError.</span>
</span><span id="Utils-531"><a href="#Utils-531"><span class="linenos">531</span></a><span class="sd">        </span>
</span><span id="Utils-532"><a href="#Utils-532"><span class="linenos">532</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-533"><a href="#Utils-533"><span class="linenos">533</span></a>
</span><span id="Utils-534"><a href="#Utils-534"><span class="linenos">534</span></a><span class="sd">            - &#39;df_to_test&#39; (DataFrame): The DataFrame to be checked for duplicates.</span>
</span><span id="Utils-535"><a href="#Utils-535"><span class="linenos">535</span></a>
</span><span id="Utils-536"><a href="#Utils-536"><span class="linenos">536</span></a><span class="sd">            - &#39;col_name&#39; (str): The name of the column to be checked for duplicates.</span>
</span><span id="Utils-537"><a href="#Utils-537"><span class="linenos">537</span></a><span class="sd">            </span>
</span><span id="Utils-538"><a href="#Utils-538"><span class="linenos">538</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-539"><a href="#Utils-539"><span class="linenos">539</span></a><span class="sd">            None. Raises an AssertionError if the column in the DataFrame has duplicate values.</span>
</span><span id="Utils-540"><a href="#Utils-540"><span class="linenos">540</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-541"><a href="#Utils-541"><span class="linenos">541</span></a>        
</span><span id="Utils-542"><a href="#Utils-542"><span class="linenos">542</span></a>        <span class="n">duplicate_df</span> <span class="o">=</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="n">df_to_test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;count &gt; 1&quot;</span><span class="p">)</span>
</span><span id="Utils-543"><a href="#Utils-543"><span class="linenos">543</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">duplicate_df</span><span class="p">)</span>
</span><span id="Utils-544"><a href="#Utils-544"><span class="linenos">544</span></a>        <span class="k">for</span> <span class="n">colonne</span> <span class="ow">in</span> <span class="n">col_name</span><span class="p">:</span>
</span><span id="Utils-545"><a href="#Utils-545"><span class="linenos">545</span></a>            <span class="k">assert</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">colonne</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">colonne</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="s2">&quot;There are duplicate entries in the DataFrame.&quot;</span>
</span><span id="Utils-546"><a href="#Utils-546"><span class="linenos">546</span></a>
</span><span id="Utils-547"><a href="#Utils-547"><span class="linenos">547</span></a>
</span><span id="Utils-548"><a href="#Utils-548"><span class="linenos">548</span></a>    <span class="k">def</span> <span class="nf">filter_by_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">condition</span> <span class="p">,</span> <span class="n">expected_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Utils-549"><a href="#Utils-549"><span class="linenos">549</span></a>
</span><span id="Utils-550"><a href="#Utils-550"><span class="linenos">550</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-551"><a href="#Utils-551"><span class="linenos">551</span></a><span class="sd">        This function filters a DataFrame based on a provided condition and then checks the filtered DataFrame against an expected DataFrame.</span>
</span><span id="Utils-552"><a href="#Utils-552"><span class="linenos">552</span></a><span class="sd">        </span>
</span><span id="Utils-553"><a href="#Utils-553"><span class="linenos">553</span></a><span class="sd">        It applies a filter to the DataFrame based on the provided condition. The filtered DataFrame is then checked against the expected DataFrame using the `filter_by_df` function.</span>
</span><span id="Utils-554"><a href="#Utils-554"><span class="linenos">554</span></a><span class="sd">        </span>
</span><span id="Utils-555"><a href="#Utils-555"><span class="linenos">555</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-556"><a href="#Utils-556"><span class="linenos">556</span></a>
</span><span id="Utils-557"><a href="#Utils-557"><span class="linenos">557</span></a><span class="sd">            - &#39;filter_df&#39; (DataFrame): The DataFrame to be filtered.</span>
</span><span id="Utils-558"><a href="#Utils-558"><span class="linenos">558</span></a>
</span><span id="Utils-559"><a href="#Utils-559"><span class="linenos">559</span></a><span class="sd">            - &#39;condition&#39;: The condition to be used for filtering the DataFrame.</span>
</span><span id="Utils-560"><a href="#Utils-560"><span class="linenos">560</span></a>
</span><span id="Utils-561"><a href="#Utils-561"><span class="linenos">561</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame after filtering.</span>
</span><span id="Utils-562"><a href="#Utils-562"><span class="linenos">562</span></a><span class="sd">                </span>
</span><span id="Utils-563"><a href="#Utils-563"><span class="linenos">563</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-564"><a href="#Utils-564"><span class="linenos">564</span></a><span class="sd">            None. The function will raise an AssertionError if the filtered DataFrame does not match the expected DataFrame.</span>
</span><span id="Utils-565"><a href="#Utils-565"><span class="linenos">565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-566"><a href="#Utils-566"><span class="linenos">566</span></a>
</span><span id="Utils-567"><a href="#Utils-567"><span class="linenos">567</span></a>        <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">filter_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>
</span><span id="Utils-568"><a href="#Utils-568"><span class="linenos">568</span></a>        <span class="n">Utils</span><span class="o">.</span><span class="n">filter_by_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_df</span> <span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span>
</span><span id="Utils-569"><a href="#Utils-569"><span class="linenos">569</span></a>
</span><span id="Utils-570"><a href="#Utils-570"><span class="linenos">570</span></a>
</span><span id="Utils-571"><a href="#Utils-571"><span class="linenos">571</span></a>
</span><span id="Utils-572"><a href="#Utils-572"><span class="linenos">572</span></a>    <span class="k">def</span> <span class="nf">filter_by_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">expected_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Utils-573"><a href="#Utils-573"><span class="linenos">573</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-574"><a href="#Utils-574"><span class="linenos">574</span></a><span class="sd">        This function checks if a filtered DataFrame matches an expected DataFrame.</span>
</span><span id="Utils-575"><a href="#Utils-575"><span class="linenos">575</span></a><span class="sd">        </span>
</span><span id="Utils-576"><a href="#Utils-576"><span class="linenos">576</span></a><span class="sd">        It applies a filter to the DataFrame based on the provided condition. Then, it checks if any rows from the filtered DataFrame exist in the unfiltered DataFrame. If they do, an AssertionError is raised. Finally, it checks if the filtered DataFrame matches the expected DataFrame using the `assertDataFrameEqual` function.</span>
</span><span id="Utils-577"><a href="#Utils-577"><span class="linenos">577</span></a><span class="sd">        </span>
</span><span id="Utils-578"><a href="#Utils-578"><span class="linenos">578</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-579"><a href="#Utils-579"><span class="linenos">579</span></a>
</span><span id="Utils-580"><a href="#Utils-580"><span class="linenos">580</span></a><span class="sd">            - &#39;filter_df&#39; (DataFrame) : The DataFrame to be filtered.</span>
</span><span id="Utils-581"><a href="#Utils-581"><span class="linenos">581</span></a>
</span><span id="Utils-582"><a href="#Utils-582"><span class="linenos">582</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame) : The expected DataFrame after filtering.</span>
</span><span id="Utils-583"><a href="#Utils-583"><span class="linenos">583</span></a><span class="sd">                </span>
</span><span id="Utils-584"><a href="#Utils-584"><span class="linenos">584</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-585"><a href="#Utils-585"><span class="linenos">585</span></a><span class="sd">            None. Raises an AssertionError if the filtered DataFrame does not match the expected DataFrame or if any rows from the filtered DataFrame exist in the unfiltered DataFrame.</span>
</span><span id="Utils-586"><a href="#Utils-586"><span class="linenos">586</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-587"><a href="#Utils-587"><span class="linenos">587</span></a>
</span><span id="Utils-588"><a href="#Utils-588"><span class="linenos">588</span></a>        <span class="n">df_unfiltered</span> <span class="o">=</span> <span class="n">filter_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">expected_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">filter_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left_anti&quot;</span><span class="p">)</span>
</span><span id="Utils-589"><a href="#Utils-589"><span class="linenos">589</span></a>        <span class="n">df_filtered_condition</span> <span class="o">=</span> <span class="n">expected_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filter_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">filter_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left_anti&quot;</span><span class="p">)</span>
</span><span id="Utils-590"><a href="#Utils-590"><span class="linenos">590</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">df_filtered_condition</span><span class="p">)</span>
</span><span id="Utils-591"><a href="#Utils-591"><span class="linenos">591</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">df_unfiltered</span><span class="p">)</span>
</span><span id="Utils-592"><a href="#Utils-592"><span class="linenos">592</span></a>
</span><span id="Utils-593"><a href="#Utils-593"><span class="linenos">593</span></a>        <span class="k">assert</span> <span class="n">df_unfiltered</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;The filtering condition did not exclude all expected rows.&quot;</span>
</span><span id="Utils-594"><a href="#Utils-594"><span class="linenos">594</span></a>        <span class="k">assert</span> <span class="n">df_filtered_condition</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;The filtering condition excluded some unexpected rows.&quot;</span>
</span><span id="Utils-595"><a href="#Utils-595"><span class="linenos">595</span></a>
</span><span id="Utils-596"><a href="#Utils-596"><span class="linenos">596</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">filter_df</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">),</span> <span class="s2">&quot;The filtered DataFrame does not match the expected DataFrame.&quot;</span>
</span><span id="Utils-597"><a href="#Utils-597"><span class="linenos">597</span></a>
</span><span id="Utils-598"><a href="#Utils-598"><span class="linenos">598</span></a>
</span><span id="Utils-599"><a href="#Utils-599"><span class="linenos">599</span></a>    <span class="k">def</span> <span class="nf">write_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Utils-600"><a href="#Utils-600"><span class="linenos">600</span></a>
</span><span id="Utils-601"><a href="#Utils-601"><span class="linenos">601</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils-602"><a href="#Utils-602"><span class="linenos">602</span></a><span class="sd">        Checks if a file exists at the specified path.</span>
</span><span id="Utils-603"><a href="#Utils-603"><span class="linenos">603</span></a><span class="sd">        </span>
</span><span id="Utils-604"><a href="#Utils-604"><span class="linenos">604</span></a><span class="sd">        This function splits the file path to get its type, then checks if a file exists at the given location. If the check fails, the function raises an AssertionError.</span>
</span><span id="Utils-605"><a href="#Utils-605"><span class="linenos">605</span></a><span class="sd">        </span>
</span><span id="Utils-606"><a href="#Utils-606"><span class="linenos">606</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils-607"><a href="#Utils-607"><span class="linenos">607</span></a><span class="sd">        </span>
</span><span id="Utils-608"><a href="#Utils-608"><span class="linenos">608</span></a><span class="sd">            - &#39;file_path&#39; (str): The file path.</span>
</span><span id="Utils-609"><a href="#Utils-609"><span class="linenos">609</span></a><span class="sd">                    </span>
</span><span id="Utils-610"><a href="#Utils-610"><span class="linenos">610</span></a><span class="sd">        Returns:</span>
</span><span id="Utils-611"><a href="#Utils-611"><span class="linenos">611</span></a><span class="sd">            None. Raises an AssertionError if the file does not exist at the specified path.</span>
</span><span id="Utils-612"><a href="#Utils-612"><span class="linenos">612</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils-613"><a href="#Utils-613"><span class="linenos">613</span></a>        
</span><span id="Utils-614"><a href="#Utils-614"><span class="linenos">614</span></a>        <span class="n">start_path</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Utils-615"><a href="#Utils-615"><span class="linenos">615</span></a>        <span class="n">start_accepted</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;abfss&quot;</span><span class="p">,</span> <span class="s2">&quot;https&quot;</span> <span class="p">,</span> <span class="s2">&quot;adl&quot;</span><span class="p">]</span>
</span><span id="Utils-616"><a href="#Utils-616"><span class="linenos">616</span></a>
</span><span id="Utils-617"><a href="#Utils-617"><span class="linenos">617</span></a>        <span class="k">if</span> <span class="n">start_path</span> <span class="ow">in</span> <span class="n">start_accepted</span><span class="p">:</span>
</span><span id="Utils-618"><a href="#Utils-618"><span class="linenos">618</span></a>
</span><span id="Utils-619"><a href="#Utils-619"><span class="linenos">619</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Utils-620"><a href="#Utils-620"><span class="linenos">620</span></a>                <span class="n">file_list</span> <span class="o">=</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils-621"><a href="#Utils-621"><span class="linenos">621</span></a>
</span><span id="Utils-622"><a href="#Utils-622"><span class="linenos">622</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils-623"><a href="#Utils-623"><span class="linenos">623</span></a>                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The file does not exist at the specified path : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Utils-624"><a href="#Utils-624"><span class="linenos">624</span></a>
</span><span id="Utils-625"><a href="#Utils-625"><span class="linenos">625</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Utils-626"><a href="#Utils-626"><span class="linenos">626</span></a>            <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="s2">&quot;The file does not exist at the specified path.&quot;</span>
</span></pre></div>


    

                            <div id="Utils.__init__" class="classattr">
                                        <input id="Utils.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Utils</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">storage_name</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">scope</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="Utils.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.__init__-15"><a href="#Utils.__init__-15"><span class="linenos">15</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">scope</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="Utils.__init__-16"><a href="#Utils.__init__-16"><span class="linenos">16</span></a>
</span><span id="Utils.__init__-17"><a href="#Utils.__init__-17"><span class="linenos">17</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.__init__-18"><a href="#Utils.__init__-18"><span class="linenos">18</span></a><span class="sd">        Initializes the class with the given storage name, scope, and key.</span>
</span><span id="Utils.__init__-19"><a href="#Utils.__init__-19"><span class="linenos">19</span></a><span class="sd">        </span>
</span><span id="Utils.__init__-20"><a href="#Utils.__init__-20"><span class="linenos">20</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.__init__-21"><a href="#Utils.__init__-21"><span class="linenos">21</span></a><span class="sd">            - &#39;storage_name&#39; (str): The name of the storage.</span>
</span><span id="Utils.__init__-22"><a href="#Utils.__init__-22"><span class="linenos">22</span></a><span class="sd">            - &#39;scope&#39; (str, optional): The scope of the storage.</span>
</span><span id="Utils.__init__-23"><a href="#Utils.__init__-23"><span class="linenos">23</span></a><span class="sd">            - &#39;key&#39; (str, optional): The key for the storage.</span>
</span><span id="Utils.__init__-24"><a href="#Utils.__init__-24"><span class="linenos">24</span></a><span class="sd">            </span>
</span><span id="Utils.__init__-25"><a href="#Utils.__init__-25"><span class="linenos">25</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.__init__-26"><a href="#Utils.__init__-26"><span class="linenos">26</span></a><span class="sd">            None.</span>
</span><span id="Utils.__init__-27"><a href="#Utils.__init__-27"><span class="linenos">27</span></a><span class="sd">        &quot;&quot;&quot;</span>   
</span><span id="Utils.__init__-28"><a href="#Utils.__init__-28"><span class="linenos">28</span></a>
</span><span id="Utils.__init__-29"><a href="#Utils.__init__-29"><span class="linenos">29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">storage_name</span> <span class="o">=</span> <span class="n">storage_name</span>
</span><span id="Utils.__init__-30"><a href="#Utils.__init__-30"><span class="linenos">30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">scope</span> <span class="o">=</span> <span class="n">scope</span>
</span><span id="Utils.__init__-31"><a href="#Utils.__init__-31"><span class="linenos">31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the class with the given storage name, scope, and key.</p>

<p>Parameters:
    - 'storage_name' (str): The name of the storage.
    - 'scope' (str, optional): The scope of the storage.
    - 'key' (str, optional): The key for the storage.</p>

<p>Returns:
    None.</p>
</div>


                            </div>
                            <div id="Utils.storage_name" class="classattr">
                                <div class="attr variable">
            <span class="name">storage_name</span>        =
<span class="default_value">&#39;&#39;</span>

        
    </div>
    <a class="headerlink" href="#Utils.storage_name"></a>
    
    

                            </div>
                            <div id="Utils.scope" class="classattr">
                                <div class="attr variable">
            <span class="name">scope</span>        =
<span class="default_value">&#39;&#39;</span>

        
    </div>
    <a class="headerlink" href="#Utils.scope"></a>
    
    

                            </div>
                            <div id="Utils.key" class="classattr">
                                <div class="attr variable">
            <span class="name">key</span>        =
<span class="default_value">&#39;&#39;</span>

        
    </div>
    <a class="headerlink" href="#Utils.key"></a>
    
    

                            </div>
                            <div id="Utils.connect_storage" class="classattr">
                                        <input id="Utils.connect_storage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">connect_storage</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.connect_storage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.connect_storage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.connect_storage-33"><a href="#Utils.connect_storage-33"><span class="linenos">33</span></a>    <span class="k">def</span> <span class="nf">connect_storage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Utils.connect_storage-34"><a href="#Utils.connect_storage-34"><span class="linenos">34</span></a><span class="w">        </span>
</span><span id="Utils.connect_storage-35"><a href="#Utils.connect_storage-35"><span class="linenos">35</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.connect_storage-36"><a href="#Utils.connect_storage-36"><span class="linenos">36</span></a><span class="sd">        Connects to the storage using the given scope and key.</span>
</span><span id="Utils.connect_storage-37"><a href="#Utils.connect_storage-37"><span class="linenos">37</span></a><span class="sd">        </span>
</span><span id="Utils.connect_storage-38"><a href="#Utils.connect_storage-38"><span class="linenos">38</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.connect_storage-39"><a href="#Utils.connect_storage-39"><span class="linenos">39</span></a><span class="sd">            </span>
</span><span id="Utils.connect_storage-40"><a href="#Utils.connect_storage-40"><span class="linenos">40</span></a><span class="sd">            - None.</span>
</span><span id="Utils.connect_storage-41"><a href="#Utils.connect_storage-41"><span class="linenos">41</span></a><span class="sd">            </span>
</span><span id="Utils.connect_storage-42"><a href="#Utils.connect_storage-42"><span class="linenos">42</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.connect_storage-43"><a href="#Utils.connect_storage-43"><span class="linenos">43</span></a><span class="sd">            None. Sets the configuration for the Azure Data Lake Storage Gen2 account.</span>
</span><span id="Utils.connect_storage-44"><a href="#Utils.connect_storage-44"><span class="linenos">44</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.connect_storage-45"><a href="#Utils.connect_storage-45"><span class="linenos">45</span></a>
</span><span id="Utils.connect_storage-46"><a href="#Utils.connect_storage-46"><span class="linenos">46</span></a>        <span class="n">ADLS2AccountKey</span> <span class="o">=</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">secrets</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">scope</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">scope</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
</span><span id="Utils.connect_storage-47"><a href="#Utils.connect_storage-47"><span class="linenos">47</span></a>        <span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;fs.azure.account.key.&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">storage_name</span> <span class="o">+</span> <span class="s2">&quot;.dfs.core.windows.net&quot;</span><span class="p">,</span> <span class="n">ADLS2AccountKey</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Connects to the storage using the given scope and key.</p>

<p>Parameters:</p>

<pre><code>- None.
</code></pre>

<p>Returns:
    None. Sets the configuration for the Azure Data Lake Storage Gen2 account.</p>
</div>


                            </div>
                            <div id="Utils.new_df" class="classattr">
                                        <input id="Utils.new_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">new_df</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">new_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">expected_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.new_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.new_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.new_df-49"><a href="#Utils.new_df-49"><span class="linenos">49</span></a>    <span class="k">def</span> <span class="nf">new_df</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">new_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">expected_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Utils.new_df-50"><a href="#Utils.new_df-50"><span class="linenos">50</span></a>
</span><span id="Utils.new_df-51"><a href="#Utils.new_df-51"><span class="linenos">51</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.new_df-52"><a href="#Utils.new_df-52"><span class="linenos">52</span></a><span class="sd">        Tests the creation of a new dataframe by comparing the created dataframe and its schema to an expected dataframe and an expected schema.</span>
</span><span id="Utils.new_df-53"><a href="#Utils.new_df-53"><span class="linenos">53</span></a><span class="sd">        </span>
</span><span id="Utils.new_df-54"><a href="#Utils.new_df-54"><span class="linenos">54</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.new_df-55"><a href="#Utils.new_df-55"><span class="linenos">55</span></a><span class="sd">            </span>
</span><span id="Utils.new_df-56"><a href="#Utils.new_df-56"><span class="linenos">56</span></a><span class="sd">            - new_df (DataFrame): The newly created DataFrame. </span>
</span><span id="Utils.new_df-57"><a href="#Utils.new_df-57"><span class="linenos">57</span></a><span class="sd">            </span>
</span><span id="Utils.new_df-58"><a href="#Utils.new_df-58"><span class="linenos">58</span></a><span class="sd">            - expected_df (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="Utils.new_df-59"><a href="#Utils.new_df-59"><span class="linenos">59</span></a>
</span><span id="Utils.new_df-60"><a href="#Utils.new_df-60"><span class="linenos">60</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.new_df-61"><a href="#Utils.new_df-61"><span class="linenos">61</span></a><span class="sd">            None. Raises an AssertionError if the dataframes or schemas do not match.</span>
</span><span id="Utils.new_df-62"><a href="#Utils.new_df-62"><span class="linenos">62</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.new_df-63"><a href="#Utils.new_df-63"><span class="linenos">63</span></a>
</span><span id="Utils.new_df-64"><a href="#Utils.new_df-64"><span class="linenos">64</span></a>
</span><span id="Utils.new_df-65"><a href="#Utils.new_df-65"><span class="linenos">65</span></a>        <span class="n">df_schema</span> <span class="o">=</span> <span class="n">new_df</span><span class="o">.</span><span class="n">schema</span>
</span><span id="Utils.new_df-66"><a href="#Utils.new_df-66"><span class="linenos">66</span></a>        <span class="n">expected_schema</span> <span class="o">=</span> <span class="n">expected_df</span><span class="o">.</span><span class="n">schema</span>
</span><span id="Utils.new_df-67"><a href="#Utils.new_df-67"><span class="linenos">67</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">new_df</span> <span class="p">,</span> <span class="n">expected_df</span><span class="p">),</span> <span class="s2">&quot;The newly created DataFrame does not match the expected DataFrame.&quot;</span>
</span><span id="Utils.new_df-68"><a href="#Utils.new_df-68"><span class="linenos">68</span></a>        <span class="n">assertSchemaEqual</span><span class="p">(</span><span class="n">df_schema</span> <span class="p">,</span> <span class="n">expected_schema</span><span class="p">),</span> <span class="s2">&quot;The schema of the newly created DataFrame does not match the expected schema.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Tests the creation of a new dataframe by comparing the created dataframe and its schema to an expected dataframe and an expected schema.</p>

<p>Parameters:</p>

<pre><code>- new_df (DataFrame): The newly created DataFrame. 

- expected_df (DataFrame): The expected DataFrame for comparison.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the dataframes or schemas do not match.</p>
</div>


                            </div>
                            <div id="Utils.new_col" class="classattr">
                                        <input id="Utils.new_col-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">new_col</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">new_col</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">expected_type_new_col</span><span class="p">:</span> <span class="nb">type</span>,</span><span class="param">	<span class="n">expected_nullable</span><span class="p">:</span> <span class="nb">bool</span>,</span><span class="param">	<span class="n">initial_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">final_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.new_col-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.new_col"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.new_col-70"><a href="#Utils.new_col-70"><span class="linenos">70</span></a>    <span class="k">def</span> <span class="nf">new_col</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">new_col</span> <span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">expected_type_new_col</span> <span class="p">:</span> <span class="nb">type</span> <span class="p">,</span> <span class="n">expected_nullable</span> <span class="p">:</span> <span class="nb">bool</span> <span class="p">,</span> <span class="n">initial_df</span> <span class="p">:</span> <span class="n">DataFrame</span> <span class="p">,</span> <span class="n">final_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Utils.new_col-71"><a href="#Utils.new_col-71"><span class="linenos">71</span></a>
</span><span id="Utils.new_col-72"><a href="#Utils.new_col-72"><span class="linenos">72</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.new_col-73"><a href="#Utils.new_col-73"><span class="linenos">73</span></a><span class="sd">        Tests the creation of a new column in a dataframe by comparing the final dataframe to the initial dataframe.</span>
</span><span id="Utils.new_col-74"><a href="#Utils.new_col-74"><span class="linenos">74</span></a><span class="sd">        </span>
</span><span id="Utils.new_col-75"><a href="#Utils.new_col-75"><span class="linenos">75</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.new_col-76"><a href="#Utils.new_col-76"><span class="linenos">76</span></a>
</span><span id="Utils.new_col-77"><a href="#Utils.new_col-77"><span class="linenos">77</span></a><span class="sd">            - &#39;new_col&#39; (str): The name of the newly created column.</span>
</span><span id="Utils.new_col-78"><a href="#Utils.new_col-78"><span class="linenos">78</span></a>
</span><span id="Utils.new_col-79"><a href="#Utils.new_col-79"><span class="linenos">79</span></a><span class="sd">            - &#39;expected_type_new_col&#39; (type): The expected data type of the new column.</span>
</span><span id="Utils.new_col-80"><a href="#Utils.new_col-80"><span class="linenos">80</span></a>
</span><span id="Utils.new_col-81"><a href="#Utils.new_col-81"><span class="linenos">81</span></a><span class="sd">            - &#39;expected_nullable&#39; (bool): The expected nullable property of the new column.</span>
</span><span id="Utils.new_col-82"><a href="#Utils.new_col-82"><span class="linenos">82</span></a>
</span><span id="Utils.new_col-83"><a href="#Utils.new_col-83"><span class="linenos">83</span></a><span class="sd">            - &#39;initial_df&#39; (DataFrame): The initial DataFrame before the new column is added.</span>
</span><span id="Utils.new_col-84"><a href="#Utils.new_col-84"><span class="linenos">84</span></a>
</span><span id="Utils.new_col-85"><a href="#Utils.new_col-85"><span class="linenos">85</span></a><span class="sd">            - &#39;final_df&#39; (DataFrame): The final DataFrame after the new column is added.</span>
</span><span id="Utils.new_col-86"><a href="#Utils.new_col-86"><span class="linenos">86</span></a><span class="sd">            </span>
</span><span id="Utils.new_col-87"><a href="#Utils.new_col-87"><span class="linenos">87</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.new_col-88"><a href="#Utils.new_col-88"><span class="linenos">88</span></a><span class="sd">            None. Raises an AssertionError if the new column or its properties do not match the expectations.</span>
</span><span id="Utils.new_col-89"><a href="#Utils.new_col-89"><span class="linenos">89</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.new_col-90"><a href="#Utils.new_col-90"><span class="linenos">90</span></a>
</span><span id="Utils.new_col-91"><a href="#Utils.new_col-91"><span class="linenos">91</span></a>        <span class="k">assert</span> <span class="n">new_col</span> <span class="ow">in</span> <span class="n">final_df</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span><span class="s2">&quot;The new column does not exist in the final DataFrame.&quot;</span>
</span><span id="Utils.new_col-92"><a href="#Utils.new_col-92"><span class="linenos">92</span></a>        <span class="k">assert</span> <span class="n">new_col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">initial_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;The new column already exists in the initial DataFrame.&quot;</span>
</span><span id="Utils.new_col-93"><a href="#Utils.new_col-93"><span class="linenos">93</span></a>        <span class="k">assert</span> <span class="n">final_df</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span><span class="o">.</span><span class="n">dataType</span> <span class="o">==</span> <span class="n">expected_type_new_col</span> <span class="p">,</span> <span class="s2">&quot;The data type of the new column does not match the expected data type.&quot;</span>
</span><span id="Utils.new_col-94"><a href="#Utils.new_col-94"><span class="linenos">94</span></a>        <span class="k">assert</span> <span class="n">final_df</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span><span class="o">.</span><span class="n">nullable</span> <span class="o">==</span> <span class="n">expected_nullable</span> <span class="p">,</span> <span class="s2">&quot;The nullable property of the new column does not match the expected nullable property.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Tests the creation of a new column in a dataframe by comparing the final dataframe to the initial dataframe.</p>

<p>Parameters:</p>

<pre><code>- 'new_col' (str): The name of the newly created column.

- 'expected_type_new_col' (type): The expected data type of the new column.

- 'expected_nullable' (bool): The expected nullable property of the new column.

- 'initial_df' (DataFrame): The initial DataFrame before the new column is added.

- 'final_df' (DataFrame): The final DataFrame after the new column is added.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the new column or its properties do not match the expectations.</p>
</div>


                            </div>
                            <div id="Utils.renamed_col" class="classattr">
                                        <input id="Utils.renamed_col-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">renamed_col</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">renamed_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">expected_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.renamed_col-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.renamed_col"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.renamed_col-96"><a href="#Utils.renamed_col-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">renamed_col</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">renamed_df</span> <span class="p">:</span> <span class="n">DataFrame</span> <span class="p">,</span> <span class="n">expected_df</span> <span class="p">:</span> <span class="n">DataFrame</span> <span class="p">):</span>
</span><span id="Utils.renamed_col-97"><a href="#Utils.renamed_col-97"><span class="linenos"> 97</span></a>
</span><span id="Utils.renamed_col-98"><a href="#Utils.renamed_col-98"><span class="linenos"> 98</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.renamed_col-99"><a href="#Utils.renamed_col-99"><span class="linenos"> 99</span></a><span class="sd">        Tests the renaming of columns in a dataframe by comparing the renamed dataframe and its schema to an expected dataframe.</span>
</span><span id="Utils.renamed_col-100"><a href="#Utils.renamed_col-100"><span class="linenos">100</span></a><span class="sd">        </span>
</span><span id="Utils.renamed_col-101"><a href="#Utils.renamed_col-101"><span class="linenos">101</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.renamed_col-102"><a href="#Utils.renamed_col-102"><span class="linenos">102</span></a>
</span><span id="Utils.renamed_col-103"><a href="#Utils.renamed_col-103"><span class="linenos">103</span></a><span class="sd">            - &#39;renamed_df&#39; (DataFrame): The DataFrame after the columns have been renamed.</span>
</span><span id="Utils.renamed_col-104"><a href="#Utils.renamed_col-104"><span class="linenos">104</span></a>
</span><span id="Utils.renamed_col-105"><a href="#Utils.renamed_col-105"><span class="linenos">105</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="Utils.renamed_col-106"><a href="#Utils.renamed_col-106"><span class="linenos">106</span></a><span class="sd">            </span>
</span><span id="Utils.renamed_col-107"><a href="#Utils.renamed_col-107"><span class="linenos">107</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.renamed_col-108"><a href="#Utils.renamed_col-108"><span class="linenos">108</span></a><span class="sd">            None. Raises an AssertionError if the dataframes or schemas do not match the expectations.</span>
</span><span id="Utils.renamed_col-109"><a href="#Utils.renamed_col-109"><span class="linenos">109</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.renamed_col-110"><a href="#Utils.renamed_col-110"><span class="linenos">110</span></a>
</span><span id="Utils.renamed_col-111"><a href="#Utils.renamed_col-111"><span class="linenos">111</span></a>        <span class="n">renamed_schema</span> <span class="o">=</span> <span class="n">renamed_df</span><span class="o">.</span><span class="n">schema</span>
</span><span id="Utils.renamed_col-112"><a href="#Utils.renamed_col-112"><span class="linenos">112</span></a>        <span class="n">expected_schema</span> <span class="o">=</span> <span class="n">expected_df</span><span class="o">.</span><span class="n">schema</span>
</span><span id="Utils.renamed_col-113"><a href="#Utils.renamed_col-113"><span class="linenos">113</span></a>
</span><span id="Utils.renamed_col-114"><a href="#Utils.renamed_col-114"><span class="linenos">114</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">renamed_df</span> <span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The DataFrame after renaming columns does not match the expected DataFrame.&quot;</span>
</span><span id="Utils.renamed_col-115"><a href="#Utils.renamed_col-115"><span class="linenos">115</span></a>        <span class="n">assertSchemaEqual</span><span class="p">(</span><span class="n">renamed_schema</span> <span class="p">,</span> <span class="n">expected_schema</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The schema of the DataFrame after renaming columns does not match the expected schema.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Tests the renaming of columns in a dataframe by comparing the renamed dataframe and its schema to an expected dataframe.</p>

<p>Parameters:</p>

<pre><code>- 'renamed_df' (DataFrame): The DataFrame after the columns have been renamed.

- 'expected_df' (DataFrame): The expected DataFrame for comparison.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the dataframes or schemas do not match the expectations.</p>
</div>


                            </div>
                            <div id="Utils.dropped_col" class="classattr">
                                        <input id="Utils.dropped_col-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dropped_col</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">dropped_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">expected_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">dropped_col</span><span class="p">:</span> <span class="nb">list</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.dropped_col-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.dropped_col"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.dropped_col-117"><a href="#Utils.dropped_col-117"><span class="linenos">117</span></a>    <span class="k">def</span> <span class="nf">dropped_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dropped_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">dropped_col</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Utils.dropped_col-118"><a href="#Utils.dropped_col-118"><span class="linenos">118</span></a><span class="w">            </span>
</span><span id="Utils.dropped_col-119"><a href="#Utils.dropped_col-119"><span class="linenos">119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.dropped_col-120"><a href="#Utils.dropped_col-120"><span class="linenos">120</span></a><span class="sd">        Tests the dropping of columns in a dataframe by comparing the dataframe after columns have been dropped to an expected dataframe.</span>
</span><span id="Utils.dropped_col-121"><a href="#Utils.dropped_col-121"><span class="linenos">121</span></a><span class="sd">        </span>
</span><span id="Utils.dropped_col-122"><a href="#Utils.dropped_col-122"><span class="linenos">122</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.dropped_col-123"><a href="#Utils.dropped_col-123"><span class="linenos">123</span></a>
</span><span id="Utils.dropped_col-124"><a href="#Utils.dropped_col-124"><span class="linenos">124</span></a><span class="sd">            - &#39;dropped_df&#39; (DataFrame): The DataFrame after the columns have been dropped.</span>
</span><span id="Utils.dropped_col-125"><a href="#Utils.dropped_col-125"><span class="linenos">125</span></a>
</span><span id="Utils.dropped_col-126"><a href="#Utils.dropped_col-126"><span class="linenos">126</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="Utils.dropped_col-127"><a href="#Utils.dropped_col-127"><span class="linenos">127</span></a>
</span><span id="Utils.dropped_col-128"><a href="#Utils.dropped_col-128"><span class="linenos">128</span></a><span class="sd">            - &#39;dropped_col&#39; (list): The list of columns that have been dropped.</span>
</span><span id="Utils.dropped_col-129"><a href="#Utils.dropped_col-129"><span class="linenos">129</span></a><span class="sd">            </span>
</span><span id="Utils.dropped_col-130"><a href="#Utils.dropped_col-130"><span class="linenos">130</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.dropped_col-131"><a href="#Utils.dropped_col-131"><span class="linenos">131</span></a><span class="sd">            None. Raises an AssertionError if the dataframes do not match or if the dropped columns still exist in the dataframe.</span>
</span><span id="Utils.dropped_col-132"><a href="#Utils.dropped_col-132"><span class="linenos">132</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.dropped_col-133"><a href="#Utils.dropped_col-133"><span class="linenos">133</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">dropped_df</span> <span class="p">,</span> <span class="n">expected_df</span><span class="p">),</span>  <span class="s2">&quot;The DataFrame after dropping columns does not match the expected DataFrame.&quot;</span>
</span><span id="Utils.dropped_col-134"><a href="#Utils.dropped_col-134"><span class="linenos">134</span></a>        <span class="k">for</span> <span class="n">colonne</span> <span class="ow">in</span> <span class="n">dropped_col</span><span class="p">:</span>
</span><span id="Utils.dropped_col-135"><a href="#Utils.dropped_col-135"><span class="linenos">135</span></a>            <span class="k">assert</span> <span class="n">colonne</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dropped_df</span><span class="o">.</span><span class="n">columns</span> <span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The column &#39;</span><span class="si">{</span><span class="n">colonne</span><span class="si">}</span><span class="s2">&#39; was not successfully dropped from the DataFrame.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Tests the dropping of columns in a dataframe by comparing the dataframe after columns have been dropped to an expected dataframe.</p>

<p>Parameters:</p>

<pre><code>- 'dropped_df' (DataFrame): The DataFrame after the columns have been dropped.

- 'expected_df' (DataFrame): The expected DataFrame for comparison.

- 'dropped_col' (list): The list of columns that have been dropped.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the dataframes do not match or if the dropped columns still exist in the dataframe.</p>
</div>


                            </div>
                            <div id="Utils.conversion_type" class="classattr">
                                        <input id="Utils.conversion_type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">conversion_type</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">convert_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">convert_col</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">expected_type</span><span class="p">:</span> <span class="nb">type</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.conversion_type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.conversion_type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.conversion_type-137"><a href="#Utils.conversion_type-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">conversion_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">convert_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">convert_col</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">expected_type</span> <span class="p">:</span> <span class="nb">type</span><span class="p">):</span>
</span><span id="Utils.conversion_type-138"><a href="#Utils.conversion_type-138"><span class="linenos">138</span></a>
</span><span id="Utils.conversion_type-139"><a href="#Utils.conversion_type-139"><span class="linenos">139</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.conversion_type-140"><a href="#Utils.conversion_type-140"><span class="linenos">140</span></a><span class="sd">        Tests the conversion of a column&#39;s data type in a dataframe.</span>
</span><span id="Utils.conversion_type-141"><a href="#Utils.conversion_type-141"><span class="linenos">141</span></a><span class="sd">        </span>
</span><span id="Utils.conversion_type-142"><a href="#Utils.conversion_type-142"><span class="linenos">142</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.conversion_type-143"><a href="#Utils.conversion_type-143"><span class="linenos">143</span></a>
</span><span id="Utils.conversion_type-144"><a href="#Utils.conversion_type-144"><span class="linenos">144</span></a><span class="sd">            - &#39;convert_df&#39; (DataFrame): The DataFrame after the column&#39;s data type has been converted.</span>
</span><span id="Utils.conversion_type-145"><a href="#Utils.conversion_type-145"><span class="linenos">145</span></a>
</span><span id="Utils.conversion_type-146"><a href="#Utils.conversion_type-146"><span class="linenos">146</span></a><span class="sd">            - &#39;convert_col&#39; (str): The name of the column whose data type has been converted.</span>
</span><span id="Utils.conversion_type-147"><a href="#Utils.conversion_type-147"><span class="linenos">147</span></a>
</span><span id="Utils.conversion_type-148"><a href="#Utils.conversion_type-148"><span class="linenos">148</span></a><span class="sd">            - &#39;expected_type&#39; (type): The expected data type of the converted column.</span>
</span><span id="Utils.conversion_type-149"><a href="#Utils.conversion_type-149"><span class="linenos">149</span></a><span class="sd">            </span>
</span><span id="Utils.conversion_type-150"><a href="#Utils.conversion_type-150"><span class="linenos">150</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.conversion_type-151"><a href="#Utils.conversion_type-151"><span class="linenos">151</span></a><span class="sd">            None. Raises an AssertionError if the data type of the converted column does not match the expected data type.</span>
</span><span id="Utils.conversion_type-152"><a href="#Utils.conversion_type-152"><span class="linenos">152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.conversion_type-153"><a href="#Utils.conversion_type-153"><span class="linenos">153</span></a>        <span class="k">assert</span> <span class="n">convert_df</span><span class="o">.</span><span class="n">schema</span><span class="p">[</span><span class="n">convert_col</span><span class="p">]</span><span class="o">.</span><span class="n">dataType</span> <span class="o">==</span> <span class="n">expected_type</span> <span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;The data type of column &#39;</span><span class="si">{</span><span class="n">convert_col</span><span class="si">}</span><span class="s2">&#39; does not match the expected type (</span><span class="si">{</span><span class="n">expected_type</span><span class="si">}</span><span class="s2">).&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Tests the conversion of a column's data type in a dataframe.</p>

<p>Parameters:</p>

<pre><code>- 'convert_df' (DataFrame): The DataFrame after the column's data type has been converted.

- 'convert_col' (str): The name of the column whose data type has been converted.

- 'expected_type' (type): The expected data type of the converted column.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the data type of the converted column does not match the expected data type.</p>
</div>


                            </div>
                            <div id="Utils.csv_to_df" class="classattr">
                                        <input id="Utils.csv_to_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">csv_to_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.csv_to_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.csv_to_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.csv_to_df-155"><a href="#Utils.csv_to_df-155"><span class="linenos">155</span></a>    <span class="k">def</span> <span class="nf">csv_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils.csv_to_df-156"><a href="#Utils.csv_to_df-156"><span class="linenos">156</span></a>
</span><span id="Utils.csv_to_df-157"><a href="#Utils.csv_to_df-157"><span class="linenos">157</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.csv_to_df-158"><a href="#Utils.csv_to_df-158"><span class="linenos">158</span></a><span class="sd">        Converts a CSV file to a DataFrame.</span>
</span><span id="Utils.csv_to_df-159"><a href="#Utils.csv_to_df-159"><span class="linenos">159</span></a><span class="sd">        </span>
</span><span id="Utils.csv_to_df-160"><a href="#Utils.csv_to_df-160"><span class="linenos">160</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.csv_to_df-161"><a href="#Utils.csv_to_df-161"><span class="linenos">161</span></a>
</span><span id="Utils.csv_to_df-162"><a href="#Utils.csv_to_df-162"><span class="linenos">162</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the CSV file.</span>
</span><span id="Utils.csv_to_df-163"><a href="#Utils.csv_to_df-163"><span class="linenos">163</span></a>
</span><span id="Utils.csv_to_df-164"><a href="#Utils.csv_to_df-164"><span class="linenos">164</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;csv&#39;.</span>
</span><span id="Utils.csv_to_df-165"><a href="#Utils.csv_to_df-165"><span class="linenos">165</span></a>
</span><span id="Utils.csv_to_df-166"><a href="#Utils.csv_to_df-166"><span class="linenos">166</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="Utils.csv_to_df-167"><a href="#Utils.csv_to_df-167"><span class="linenos">167</span></a><span class="sd">                    </span>
</span><span id="Utils.csv_to_df-168"><a href="#Utils.csv_to_df-168"><span class="linenos">168</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.csv_to_df-169"><a href="#Utils.csv_to_df-169"><span class="linenos">169</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the CSV file.</span>
</span><span id="Utils.csv_to_df-170"><a href="#Utils.csv_to_df-170"><span class="linenos">170</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.csv_to_df-171"><a href="#Utils.csv_to_df-171"><span class="linenos">171</span></a>
</span><span id="Utils.csv_to_df-172"><a href="#Utils.csv_to_df-172"><span class="linenos">172</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils.csv_to_df-173"><a href="#Utils.csv_to_df-173"><span class="linenos">173</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;csv&quot;</span><span class="p">:</span>
</span><span id="Utils.csv_to_df-174"><a href="#Utils.csv_to_df-174"><span class="linenos">174</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils.csv_to_df-175"><a href="#Utils.csv_to_df-175"><span class="linenos">175</span></a>            
</span><span id="Utils.csv_to_df-176"><a href="#Utils.csv_to_df-176"><span class="linenos">176</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils.csv_to_df-177"><a href="#Utils.csv_to_df-177"><span class="linenos">177</span></a>            
</span><span id="Utils.csv_to_df-178"><a href="#Utils.csv_to_df-178"><span class="linenos">178</span></a>            <span class="k">return</span> <span class="n">expected_df</span>
</span><span id="Utils.csv_to_df-179"><a href="#Utils.csv_to_df-179"><span class="linenos">179</span></a>        
</span><span id="Utils.csv_to_df-180"><a href="#Utils.csv_to_df-180"><span class="linenos">180</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils.csv_to_df-181"><a href="#Utils.csv_to_df-181"><span class="linenos">181</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts a CSV file to a DataFrame.</p>

<p>Parameters:</p>

<pre><code>- 'file_path' (str): The path to the CSV file.

- 'file_type' (str): The type of the file. In this case, it should be 'csv'.

- 'options' (dict): Options for reading the file.
</code></pre>

<p>Returns:
    'expected_df' (DataFrame): The DataFrame created from the CSV file.</p>
</div>


                            </div>
                            <div id="Utils.xlsx_to_df" class="classattr">
                                        <input id="Utils.xlsx_to_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xlsx_to_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.xlsx_to_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.xlsx_to_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.xlsx_to_df-183"><a href="#Utils.xlsx_to_df-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">xlsx_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils.xlsx_to_df-184"><a href="#Utils.xlsx_to_df-184"><span class="linenos">184</span></a>
</span><span id="Utils.xlsx_to_df-185"><a href="#Utils.xlsx_to_df-185"><span class="linenos">185</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.xlsx_to_df-186"><a href="#Utils.xlsx_to_df-186"><span class="linenos">186</span></a><span class="sd">        Converts an XLSX file to a DataFrame.</span>
</span><span id="Utils.xlsx_to_df-187"><a href="#Utils.xlsx_to_df-187"><span class="linenos">187</span></a><span class="sd">        </span>
</span><span id="Utils.xlsx_to_df-188"><a href="#Utils.xlsx_to_df-188"><span class="linenos">188</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.xlsx_to_df-189"><a href="#Utils.xlsx_to_df-189"><span class="linenos">189</span></a>
</span><span id="Utils.xlsx_to_df-190"><a href="#Utils.xlsx_to_df-190"><span class="linenos">190</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the XLSX file.</span>
</span><span id="Utils.xlsx_to_df-191"><a href="#Utils.xlsx_to_df-191"><span class="linenos">191</span></a>
</span><span id="Utils.xlsx_to_df-192"><a href="#Utils.xlsx_to_df-192"><span class="linenos">192</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;xlsx&#39;.</span>
</span><span id="Utils.xlsx_to_df-193"><a href="#Utils.xlsx_to_df-193"><span class="linenos">193</span></a>
</span><span id="Utils.xlsx_to_df-194"><a href="#Utils.xlsx_to_df-194"><span class="linenos">194</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.           </span>
</span><span id="Utils.xlsx_to_df-195"><a href="#Utils.xlsx_to_df-195"><span class="linenos">195</span></a><span class="sd">            </span>
</span><span id="Utils.xlsx_to_df-196"><a href="#Utils.xlsx_to_df-196"><span class="linenos">196</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.xlsx_to_df-197"><a href="#Utils.xlsx_to_df-197"><span class="linenos">197</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the XLSX file.</span>
</span><span id="Utils.xlsx_to_df-198"><a href="#Utils.xlsx_to_df-198"><span class="linenos">198</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.xlsx_to_df-199"><a href="#Utils.xlsx_to_df-199"><span class="linenos">199</span></a>
</span><span id="Utils.xlsx_to_df-200"><a href="#Utils.xlsx_to_df-200"><span class="linenos">200</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils.xlsx_to_df-201"><a href="#Utils.xlsx_to_df-201"><span class="linenos">201</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s1">&#39;xlsx&#39;</span><span class="p">:</span>
</span><span id="Utils.xlsx_to_df-202"><a href="#Utils.xlsx_to_df-202"><span class="linenos">202</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils.xlsx_to_df-203"><a href="#Utils.xlsx_to_df-203"><span class="linenos">203</span></a>            
</span><span id="Utils.xlsx_to_df-204"><a href="#Utils.xlsx_to_df-204"><span class="linenos">204</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils.xlsx_to_df-205"><a href="#Utils.xlsx_to_df-205"><span class="linenos">205</span></a>            <span class="k">return</span> <span class="n">expected_df</span> 
</span><span id="Utils.xlsx_to_df-206"><a href="#Utils.xlsx_to_df-206"><span class="linenos">206</span></a>         
</span><span id="Utils.xlsx_to_df-207"><a href="#Utils.xlsx_to_df-207"><span class="linenos">207</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils.xlsx_to_df-208"><a href="#Utils.xlsx_to_df-208"><span class="linenos">208</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts an XLSX file to a DataFrame.</p>

<p>Parameters:</p>

<pre><code>- 'file_path' (str): The path to the XLSX file.

- 'file_type' (str): The type of the file. In this case, it should be 'xlsx'.

- 'options' (dict): Options for reading the file.
</code></pre>

<p>Returns:
    'expected_df' (DataFrame): The DataFrame created from the XLSX file.</p>
</div>


                            </div>
                            <div id="Utils.txt_to_df" class="classattr">
                                        <input id="Utils.txt_to_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">txt_to_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.txt_to_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.txt_to_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.txt_to_df-210"><a href="#Utils.txt_to_df-210"><span class="linenos">210</span></a>    <span class="k">def</span> <span class="nf">txt_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span> 
</span><span id="Utils.txt_to_df-211"><a href="#Utils.txt_to_df-211"><span class="linenos">211</span></a>
</span><span id="Utils.txt_to_df-212"><a href="#Utils.txt_to_df-212"><span class="linenos">212</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.txt_to_df-213"><a href="#Utils.txt_to_df-213"><span class="linenos">213</span></a><span class="sd">        Converts a TXT file to a DataFrame.</span>
</span><span id="Utils.txt_to_df-214"><a href="#Utils.txt_to_df-214"><span class="linenos">214</span></a><span class="sd">        </span>
</span><span id="Utils.txt_to_df-215"><a href="#Utils.txt_to_df-215"><span class="linenos">215</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.txt_to_df-216"><a href="#Utils.txt_to_df-216"><span class="linenos">216</span></a>
</span><span id="Utils.txt_to_df-217"><a href="#Utils.txt_to_df-217"><span class="linenos">217</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the TXT file.</span>
</span><span id="Utils.txt_to_df-218"><a href="#Utils.txt_to_df-218"><span class="linenos">218</span></a>
</span><span id="Utils.txt_to_df-219"><a href="#Utils.txt_to_df-219"><span class="linenos">219</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;txt&#39;.</span>
</span><span id="Utils.txt_to_df-220"><a href="#Utils.txt_to_df-220"><span class="linenos">220</span></a>
</span><span id="Utils.txt_to_df-221"><a href="#Utils.txt_to_df-221"><span class="linenos">221</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.            </span>
</span><span id="Utils.txt_to_df-222"><a href="#Utils.txt_to_df-222"><span class="linenos">222</span></a><span class="sd">            </span>
</span><span id="Utils.txt_to_df-223"><a href="#Utils.txt_to_df-223"><span class="linenos">223</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.txt_to_df-224"><a href="#Utils.txt_to_df-224"><span class="linenos">224</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the TXT file.</span>
</span><span id="Utils.txt_to_df-225"><a href="#Utils.txt_to_df-225"><span class="linenos">225</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.txt_to_df-226"><a href="#Utils.txt_to_df-226"><span class="linenos">226</span></a>        
</span><span id="Utils.txt_to_df-227"><a href="#Utils.txt_to_df-227"><span class="linenos">227</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils.txt_to_df-228"><a href="#Utils.txt_to_df-228"><span class="linenos">228</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;txt&quot;</span> <span class="p">:</span>
</span><span id="Utils.txt_to_df-229"><a href="#Utils.txt_to_df-229"><span class="linenos">229</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>           
</span><span id="Utils.txt_to_df-230"><a href="#Utils.txt_to_df-230"><span class="linenos">230</span></a>            
</span><span id="Utils.txt_to_df-231"><a href="#Utils.txt_to_df-231"><span class="linenos">231</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils.txt_to_df-232"><a href="#Utils.txt_to_df-232"><span class="linenos">232</span></a>            <span class="k">return</span> <span class="n">expected_df</span> 
</span><span id="Utils.txt_to_df-233"><a href="#Utils.txt_to_df-233"><span class="linenos">233</span></a>        
</span><span id="Utils.txt_to_df-234"><a href="#Utils.txt_to_df-234"><span class="linenos">234</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils.txt_to_df-235"><a href="#Utils.txt_to_df-235"><span class="linenos">235</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts a TXT file to a DataFrame.</p>

<p>Parameters:</p>

<pre><code>- 'file_path' (str): The path to the TXT file.

- 'file_type' (str): The type of the file. In this case, it should be 'txt'.

- 'options' (dict): Options for reading the file.
</code></pre>

<p>Returns:
    'expected_df' (DataFrame): The DataFrame created from the TXT file.</p>
</div>


                            </div>
                            <div id="Utils.json_to_df" class="classattr">
                                        <input id="Utils.json_to_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">json_to_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.json_to_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.json_to_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.json_to_df-237"><a href="#Utils.json_to_df-237"><span class="linenos">237</span></a>    <span class="k">def</span> <span class="nf">json_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span> 
</span><span id="Utils.json_to_df-238"><a href="#Utils.json_to_df-238"><span class="linenos">238</span></a><span class="w">        </span>
</span><span id="Utils.json_to_df-239"><a href="#Utils.json_to_df-239"><span class="linenos">239</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.json_to_df-240"><a href="#Utils.json_to_df-240"><span class="linenos">240</span></a><span class="sd">        Converts a JSON file to a DataFrame.</span>
</span><span id="Utils.json_to_df-241"><a href="#Utils.json_to_df-241"><span class="linenos">241</span></a><span class="sd">        </span>
</span><span id="Utils.json_to_df-242"><a href="#Utils.json_to_df-242"><span class="linenos">242</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.json_to_df-243"><a href="#Utils.json_to_df-243"><span class="linenos">243</span></a>
</span><span id="Utils.json_to_df-244"><a href="#Utils.json_to_df-244"><span class="linenos">244</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the JSON file.</span>
</span><span id="Utils.json_to_df-245"><a href="#Utils.json_to_df-245"><span class="linenos">245</span></a>
</span><span id="Utils.json_to_df-246"><a href="#Utils.json_to_df-246"><span class="linenos">246</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;json&#39;.</span>
</span><span id="Utils.json_to_df-247"><a href="#Utils.json_to_df-247"><span class="linenos">247</span></a>
</span><span id="Utils.json_to_df-248"><a href="#Utils.json_to_df-248"><span class="linenos">248</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.           </span>
</span><span id="Utils.json_to_df-249"><a href="#Utils.json_to_df-249"><span class="linenos">249</span></a><span class="sd">            </span>
</span><span id="Utils.json_to_df-250"><a href="#Utils.json_to_df-250"><span class="linenos">250</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.json_to_df-251"><a href="#Utils.json_to_df-251"><span class="linenos">251</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the JSON file.</span>
</span><span id="Utils.json_to_df-252"><a href="#Utils.json_to_df-252"><span class="linenos">252</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.json_to_df-253"><a href="#Utils.json_to_df-253"><span class="linenos">253</span></a>
</span><span id="Utils.json_to_df-254"><a href="#Utils.json_to_df-254"><span class="linenos">254</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils.json_to_df-255"><a href="#Utils.json_to_df-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;json&quot;</span> <span class="p">:</span>
</span><span id="Utils.json_to_df-256"><a href="#Utils.json_to_df-256"><span class="linenos">256</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils.json_to_df-257"><a href="#Utils.json_to_df-257"><span class="linenos">257</span></a>
</span><span id="Utils.json_to_df-258"><a href="#Utils.json_to_df-258"><span class="linenos">258</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;json&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> 
</span><span id="Utils.json_to_df-259"><a href="#Utils.json_to_df-259"><span class="linenos">259</span></a>            <span class="k">return</span> <span class="n">expected_df</span>  
</span><span id="Utils.json_to_df-260"><a href="#Utils.json_to_df-260"><span class="linenos">260</span></a>        
</span><span id="Utils.json_to_df-261"><a href="#Utils.json_to_df-261"><span class="linenos">261</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils.json_to_df-262"><a href="#Utils.json_to_df-262"><span class="linenos">262</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts a JSON file to a DataFrame.</p>

<p>Parameters:</p>

<pre><code>- 'file_path' (str): The path to the JSON file.

- 'file_type' (str): The type of the file. In this case, it should be 'json'.

- 'options' (dict): Options for reading the file.
</code></pre>

<p>Returns:
    'expected_df' (DataFrame): The DataFrame created from the JSON file.</p>
</div>


                            </div>
                            <div id="Utils.parquet_to_df" class="classattr">
                                        <input id="Utils.parquet_to_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parquet_to_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.parquet_to_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.parquet_to_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.parquet_to_df-264"><a href="#Utils.parquet_to_df-264"><span class="linenos">264</span></a>    <span class="k">def</span> <span class="nf">parquet_to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils.parquet_to_df-265"><a href="#Utils.parquet_to_df-265"><span class="linenos">265</span></a><span class="w">        </span>
</span><span id="Utils.parquet_to_df-266"><a href="#Utils.parquet_to_df-266"><span class="linenos">266</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.parquet_to_df-267"><a href="#Utils.parquet_to_df-267"><span class="linenos">267</span></a><span class="sd">        Converts a Parquet file to a DataFrame.</span>
</span><span id="Utils.parquet_to_df-268"><a href="#Utils.parquet_to_df-268"><span class="linenos">268</span></a><span class="sd">        </span>
</span><span id="Utils.parquet_to_df-269"><a href="#Utils.parquet_to_df-269"><span class="linenos">269</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.parquet_to_df-270"><a href="#Utils.parquet_to_df-270"><span class="linenos">270</span></a>
</span><span id="Utils.parquet_to_df-271"><a href="#Utils.parquet_to_df-271"><span class="linenos">271</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the Parquet file.</span>
</span><span id="Utils.parquet_to_df-272"><a href="#Utils.parquet_to_df-272"><span class="linenos">272</span></a>
</span><span id="Utils.parquet_to_df-273"><a href="#Utils.parquet_to_df-273"><span class="linenos">273</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;parquet&#39;.</span>
</span><span id="Utils.parquet_to_df-274"><a href="#Utils.parquet_to_df-274"><span class="linenos">274</span></a>
</span><span id="Utils.parquet_to_df-275"><a href="#Utils.parquet_to_df-275"><span class="linenos">275</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.           </span>
</span><span id="Utils.parquet_to_df-276"><a href="#Utils.parquet_to_df-276"><span class="linenos">276</span></a><span class="sd">            </span>
</span><span id="Utils.parquet_to_df-277"><a href="#Utils.parquet_to_df-277"><span class="linenos">277</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.parquet_to_df-278"><a href="#Utils.parquet_to_df-278"><span class="linenos">278</span></a><span class="sd">            &#39;expected_df&#39; (DataFrame): The DataFrame created from the Parquet file.</span>
</span><span id="Utils.parquet_to_df-279"><a href="#Utils.parquet_to_df-279"><span class="linenos">279</span></a><span class="sd">        &quot;&quot;&quot;</span>    
</span><span id="Utils.parquet_to_df-280"><a href="#Utils.parquet_to_df-280"><span class="linenos">280</span></a>
</span><span id="Utils.parquet_to_df-281"><a href="#Utils.parquet_to_df-281"><span class="linenos">281</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils.parquet_to_df-282"><a href="#Utils.parquet_to_df-282"><span class="linenos">282</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;parquet&quot;</span> <span class="p">:</span>
</span><span id="Utils.parquet_to_df-283"><a href="#Utils.parquet_to_df-283"><span class="linenos">283</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods type_file_to_df where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils.parquet_to_df-284"><a href="#Utils.parquet_to_df-284"><span class="linenos">284</span></a>
</span><span id="Utils.parquet_to_df-285"><a href="#Utils.parquet_to_df-285"><span class="linenos">285</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;parquet&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span> 
</span><span id="Utils.parquet_to_df-286"><a href="#Utils.parquet_to_df-286"><span class="linenos">286</span></a>            <span class="k">return</span> <span class="n">expected_df</span>  
</span><span id="Utils.parquet_to_df-287"><a href="#Utils.parquet_to_df-287"><span class="linenos">287</span></a>        
</span><span id="Utils.parquet_to_df-288"><a href="#Utils.parquet_to_df-288"><span class="linenos">288</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils.parquet_to_df-289"><a href="#Utils.parquet_to_df-289"><span class="linenos">289</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts a Parquet file to a DataFrame.</p>

<p>Parameters:</p>

<pre><code>- 'file_path' (str): The path to the Parquet file.

- 'file_type' (str): The type of the file. In this case, it should be 'parquet'.

- 'options' (dict): Options for reading the file.
</code></pre>

<p>Returns:
    'expected_df' (DataFrame): The DataFrame created from the Parquet file.</p>
</div>


                            </div>
                            <div id="Utils.function_df_input" class="classattr">
                                        <input id="Utils.function_df_input-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function_df_input</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">expected_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">function</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">callable</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.function_df_input-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.function_df_input"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.function_df_input-291"><a href="#Utils.function_df_input-291"><span class="linenos">291</span></a>    <span class="k">def</span> <span class="nf">function_df_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Utils.function_df_input-292"><a href="#Utils.function_df_input-292"><span class="linenos">292</span></a>
</span><span id="Utils.function_df_input-293"><a href="#Utils.function_df_input-293"><span class="linenos">293</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.function_df_input-294"><a href="#Utils.function_df_input-294"><span class="linenos">294</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame.</span>
</span><span id="Utils.function_df_input-295"><a href="#Utils.function_df_input-295"><span class="linenos">295</span></a><span class="sd">        </span>
</span><span id="Utils.function_df_input-296"><a href="#Utils.function_df_input-296"><span class="linenos">296</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.function_df_input-297"><a href="#Utils.function_df_input-297"><span class="linenos">297</span></a>
</span><span id="Utils.function_df_input-298"><a href="#Utils.function_df_input-298"><span class="linenos">298</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="Utils.function_df_input-299"><a href="#Utils.function_df_input-299"><span class="linenos">299</span></a>
</span><span id="Utils.function_df_input-300"><a href="#Utils.function_df_input-300"><span class="linenos">300</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="Utils.function_df_input-301"><a href="#Utils.function_df_input-301"><span class="linenos">301</span></a>
</span><span id="Utils.function_df_input-302"><a href="#Utils.function_df_input-302"><span class="linenos">302</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="Utils.function_df_input-303"><a href="#Utils.function_df_input-303"><span class="linenos">303</span></a><span class="sd">            </span>
</span><span id="Utils.function_df_input-304"><a href="#Utils.function_df_input-304"><span class="linenos">304</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.function_df_input-305"><a href="#Utils.function_df_input-305"><span class="linenos">305</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="Utils.function_df_input-306"><a href="#Utils.function_df_input-306"><span class="linenos">306</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.function_df_input-307"><a href="#Utils.function_df_input-307"><span class="linenos">307</span></a>
</span><span id="Utils.function_df_input-308"><a href="#Utils.function_df_input-308"><span class="linenos">308</span></a>        <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="Utils.function_df_input-309"><a href="#Utils.function_df_input-309"><span class="linenos">309</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">expected_df</span><span class="p">,</span> <span class="n">df_result</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame.</p>

<p>Parameters:</p>

<pre><code>- 'expected_df' (DataFrame): The expected DataFrame for comparison.

- 'function' (callable): The function to be tested.

- 'list_func_param' (list): The list of parameters to be passed to the function.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</p>
</div>


                            </div>
                            <div id="Utils.file_result_df_input" class="classattr">
                                        <input id="Utils.file_result_df_input-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">file_result_df_input</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">expected_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.file_result_df_input-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.file_result_df_input"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.file_result_df_input-311"><a href="#Utils.file_result_df_input-311"><span class="linenos">311</span></a>    <span class="k">def</span> <span class="nf">file_result_df_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils.file_result_df_input-312"><a href="#Utils.file_result_df_input-312"><span class="linenos">312</span></a>
</span><span id="Utils.file_result_df_input-313"><a href="#Utils.file_result_df_input-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.file_result_df_input-314"><a href="#Utils.file_result_df_input-314"><span class="linenos">314</span></a><span class="sd">        Reads a DataFrame from a specified file path using the given file type and options.</span>
</span><span id="Utils.file_result_df_input-315"><a href="#Utils.file_result_df_input-315"><span class="linenos">315</span></a><span class="sd">        Compares the resulting DataFrame with an expected DataFrame for equality.</span>
</span><span id="Utils.file_result_df_input-316"><a href="#Utils.file_result_df_input-316"><span class="linenos">316</span></a><span class="sd">        </span>
</span><span id="Utils.file_result_df_input-317"><a href="#Utils.file_result_df_input-317"><span class="linenos">317</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.file_result_df_input-318"><a href="#Utils.file_result_df_input-318"><span class="linenos">318</span></a>
</span><span id="Utils.file_result_df_input-319"><a href="#Utils.file_result_df_input-319"><span class="linenos">319</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame for comparison.</span>
</span><span id="Utils.file_result_df_input-320"><a href="#Utils.file_result_df_input-320"><span class="linenos">320</span></a>
</span><span id="Utils.file_result_df_input-321"><a href="#Utils.file_result_df_input-321"><span class="linenos">321</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file to be read.</span>
</span><span id="Utils.file_result_df_input-322"><a href="#Utils.file_result_df_input-322"><span class="linenos">322</span></a>
</span><span id="Utils.file_result_df_input-323"><a href="#Utils.file_result_df_input-323"><span class="linenos">323</span></a><span class="sd">            - &#39;file_type&#39; (str): The format of the file (e.g., &#39;parquet&#39;, &#39;csv&#39;, etc.).</span>
</span><span id="Utils.file_result_df_input-324"><a href="#Utils.file_result_df_input-324"><span class="linenos">324</span></a>
</span><span id="Utils.file_result_df_input-325"><a href="#Utils.file_result_df_input-325"><span class="linenos">325</span></a><span class="sd">            - &#39;options&#39; (dict, optional): Additional options for reading the file (default: {}).</span>
</span><span id="Utils.file_result_df_input-326"><a href="#Utils.file_result_df_input-326"><span class="linenos">326</span></a><span class="sd">            </span>
</span><span id="Utils.file_result_df_input-327"><a href="#Utils.file_result_df_input-327"><span class="linenos">327</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.file_result_df_input-328"><a href="#Utils.file_result_df_input-328"><span class="linenos">328</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame read from the file does not match the expected DataFrame.</span>
</span><span id="Utils.file_result_df_input-329"><a href="#Utils.file_result_df_input-329"><span class="linenos">329</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.file_result_df_input-330"><a href="#Utils.file_result_df_input-330"><span class="linenos">330</span></a>
</span><span id="Utils.file_result_df_input-331"><a href="#Utils.file_result_df_input-331"><span class="linenos">331</span></a>        <span class="n">df_result</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">file_type</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils.file_result_df_input-332"><a href="#Utils.file_result_df_input-332"><span class="linenos">332</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">expected_df</span><span class="p">,</span> <span class="n">df_result</span><span class="p">),</span> <span class="s2">&quot;The output DataFrame does not match the expected DataFrame.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Reads a DataFrame from a specified file path using the given file type and options.
Compares the resulting DataFrame with an expected DataFrame for equality.</p>

<p>Parameters:</p>

<pre><code>- 'expected_df' (DataFrame): The expected DataFrame for comparison.

- 'file_path' (str): The path to the file to be read.

- 'file_type' (str): The format of the file (e.g., 'parquet', 'csv', etc.).

- 'options' (dict, optional): Additional options for reading the file (default: {}).
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the DataFrame read from the file does not match the expected DataFrame.</p>
</div>


                            </div>
                            <div id="Utils.function_csv_input" class="classattr">
                                        <input id="Utils.function_csv_input-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function_csv_input</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">function</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">callable</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span>,</span><span class="param">	<span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.function_csv_input-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.function_csv_input"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.function_csv_input-335"><a href="#Utils.function_csv_input-335"><span class="linenos">335</span></a>    <span class="k">def</span> <span class="nf">function_csv_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils.function_csv_input-336"><a href="#Utils.function_csv_input-336"><span class="linenos">336</span></a>
</span><span id="Utils.function_csv_input-337"><a href="#Utils.function_csv_input-337"><span class="linenos">337</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.function_csv_input-338"><a href="#Utils.function_csv_input-338"><span class="linenos">338</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a CSV file.</span>
</span><span id="Utils.function_csv_input-339"><a href="#Utils.function_csv_input-339"><span class="linenos">339</span></a><span class="sd">        </span>
</span><span id="Utils.function_csv_input-340"><a href="#Utils.function_csv_input-340"><span class="linenos">340</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.function_csv_input-341"><a href="#Utils.function_csv_input-341"><span class="linenos">341</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="Utils.function_csv_input-342"><a href="#Utils.function_csv_input-342"><span class="linenos">342</span></a>
</span><span id="Utils.function_csv_input-343"><a href="#Utils.function_csv_input-343"><span class="linenos">343</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="Utils.function_csv_input-344"><a href="#Utils.function_csv_input-344"><span class="linenos">344</span></a>
</span><span id="Utils.function_csv_input-345"><a href="#Utils.function_csv_input-345"><span class="linenos">345</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="Utils.function_csv_input-346"><a href="#Utils.function_csv_input-346"><span class="linenos">346</span></a>
</span><span id="Utils.function_csv_input-347"><a href="#Utils.function_csv_input-347"><span class="linenos">347</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;csv&#39;.</span>
</span><span id="Utils.function_csv_input-348"><a href="#Utils.function_csv_input-348"><span class="linenos">348</span></a>
</span><span id="Utils.function_csv_input-349"><a href="#Utils.function_csv_input-349"><span class="linenos">349</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="Utils.function_csv_input-350"><a href="#Utils.function_csv_input-350"><span class="linenos">350</span></a><span class="sd">            </span>
</span><span id="Utils.function_csv_input-351"><a href="#Utils.function_csv_input-351"><span class="linenos">351</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.function_csv_input-352"><a href="#Utils.function_csv_input-352"><span class="linenos">352</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="Utils.function_csv_input-353"><a href="#Utils.function_csv_input-353"><span class="linenos">353</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.function_csv_input-354"><a href="#Utils.function_csv_input-354"><span class="linenos">354</span></a>
</span><span id="Utils.function_csv_input-355"><a href="#Utils.function_csv_input-355"><span class="linenos">355</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils.function_csv_input-356"><a href="#Utils.function_csv_input-356"><span class="linenos">356</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;csv&quot;</span><span class="p">:</span>
</span><span id="Utils.function_csv_input-357"><a href="#Utils.function_csv_input-357"><span class="linenos">357</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils.function_csv_input-358"><a href="#Utils.function_csv_input-358"><span class="linenos">358</span></a>
</span><span id="Utils.function_csv_input-359"><a href="#Utils.function_csv_input-359"><span class="linenos">359</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils.function_csv_input-360"><a href="#Utils.function_csv_input-360"><span class="linenos">360</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="Utils.function_csv_input-361"><a href="#Utils.function_csv_input-361"><span class="linenos">361</span></a>        
</span><span id="Utils.function_csv_input-362"><a href="#Utils.function_csv_input-362"><span class="linenos">362</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils.function_csv_input-363"><a href="#Utils.function_csv_input-363"><span class="linenos">363</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Utils.function_csv_input-364"><a href="#Utils.function_csv_input-364"><span class="linenos">364</span></a>        
</span><span id="Utils.function_csv_input-365"><a href="#Utils.function_csv_input-365"><span class="linenos">365</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a CSV file.</p>

<p>Parameters:
    - 'function' (callable): The function to be tested.</p>

<pre><code>- 'list_func_param' (list): The list of parameters to be passed to the function.

- 'file_path' (str): The path to the file.

- 'file_type' (str): The type of the file. In this case, it should be 'csv'.

- 'options' (dict): Options for reading the file.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</p>
</div>


                            </div>
                            <div id="Utils.function_txt_input" class="classattr">
                                        <input id="Utils.function_txt_input-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function_txt_input</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">function</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">callable</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span>,</span><span class="param">	<span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.function_txt_input-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.function_txt_input"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.function_txt_input-367"><a href="#Utils.function_txt_input-367"><span class="linenos">367</span></a>    <span class="k">def</span> <span class="nf">function_txt_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils.function_txt_input-368"><a href="#Utils.function_txt_input-368"><span class="linenos">368</span></a>
</span><span id="Utils.function_txt_input-369"><a href="#Utils.function_txt_input-369"><span class="linenos">369</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.function_txt_input-370"><a href="#Utils.function_txt_input-370"><span class="linenos">370</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a TXT file.</span>
</span><span id="Utils.function_txt_input-371"><a href="#Utils.function_txt_input-371"><span class="linenos">371</span></a><span class="sd">        </span>
</span><span id="Utils.function_txt_input-372"><a href="#Utils.function_txt_input-372"><span class="linenos">372</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.function_txt_input-373"><a href="#Utils.function_txt_input-373"><span class="linenos">373</span></a>
</span><span id="Utils.function_txt_input-374"><a href="#Utils.function_txt_input-374"><span class="linenos">374</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="Utils.function_txt_input-375"><a href="#Utils.function_txt_input-375"><span class="linenos">375</span></a>
</span><span id="Utils.function_txt_input-376"><a href="#Utils.function_txt_input-376"><span class="linenos">376</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="Utils.function_txt_input-377"><a href="#Utils.function_txt_input-377"><span class="linenos">377</span></a>
</span><span id="Utils.function_txt_input-378"><a href="#Utils.function_txt_input-378"><span class="linenos">378</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="Utils.function_txt_input-379"><a href="#Utils.function_txt_input-379"><span class="linenos">379</span></a>
</span><span id="Utils.function_txt_input-380"><a href="#Utils.function_txt_input-380"><span class="linenos">380</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;txt&#39;.</span>
</span><span id="Utils.function_txt_input-381"><a href="#Utils.function_txt_input-381"><span class="linenos">381</span></a>
</span><span id="Utils.function_txt_input-382"><a href="#Utils.function_txt_input-382"><span class="linenos">382</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="Utils.function_txt_input-383"><a href="#Utils.function_txt_input-383"><span class="linenos">383</span></a>
</span><span id="Utils.function_txt_input-384"><a href="#Utils.function_txt_input-384"><span class="linenos">384</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.function_txt_input-385"><a href="#Utils.function_txt_input-385"><span class="linenos">385</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="Utils.function_txt_input-386"><a href="#Utils.function_txt_input-386"><span class="linenos">386</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.function_txt_input-387"><a href="#Utils.function_txt_input-387"><span class="linenos">387</span></a>
</span><span id="Utils.function_txt_input-388"><a href="#Utils.function_txt_input-388"><span class="linenos">388</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils.function_txt_input-389"><a href="#Utils.function_txt_input-389"><span class="linenos">389</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;txt&quot;</span><span class="p">:</span>
</span><span id="Utils.function_txt_input-390"><a href="#Utils.function_txt_input-390"><span class="linenos">390</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils.function_txt_input-391"><a href="#Utils.function_txt_input-391"><span class="linenos">391</span></a>
</span><span id="Utils.function_txt_input-392"><a href="#Utils.function_txt_input-392"><span class="linenos">392</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils.function_txt_input-393"><a href="#Utils.function_txt_input-393"><span class="linenos">393</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="Utils.function_txt_input-394"><a href="#Utils.function_txt_input-394"><span class="linenos">394</span></a>
</span><span id="Utils.function_txt_input-395"><a href="#Utils.function_txt_input-395"><span class="linenos">395</span></a>
</span><span id="Utils.function_txt_input-396"><a href="#Utils.function_txt_input-396"><span class="linenos">396</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils.function_txt_input-397"><a href="#Utils.function_txt_input-397"><span class="linenos">397</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Utils.function_txt_input-398"><a href="#Utils.function_txt_input-398"><span class="linenos">398</span></a>
</span><span id="Utils.function_txt_input-399"><a href="#Utils.function_txt_input-399"><span class="linenos">399</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a TXT file.</p>

<p>Parameters:</p>

<pre><code>- 'function' (callable): The function to be tested.

- 'list_func_param' (list): The list of parameters to be passed to the function.

- 'file_path' (str): The path to the file.

- 'file_type' (str): The type of the file. In this case, it should be 'txt'.

- 'options' (dict): Options for reading the file.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</p>
</div>


                            </div>
                            <div id="Utils.function_xlsx_input" class="classattr">
                                        <input id="Utils.function_xlsx_input-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function_xlsx_input</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">function</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">callable</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span>,</span><span class="param">	<span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.function_xlsx_input-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.function_xlsx_input"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.function_xlsx_input-401"><a href="#Utils.function_xlsx_input-401"><span class="linenos">401</span></a>    <span class="k">def</span> <span class="nf">function_xlsx_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils.function_xlsx_input-402"><a href="#Utils.function_xlsx_input-402"><span class="linenos">402</span></a>
</span><span id="Utils.function_xlsx_input-403"><a href="#Utils.function_xlsx_input-403"><span class="linenos">403</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.function_xlsx_input-404"><a href="#Utils.function_xlsx_input-404"><span class="linenos">404</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from an XLSX file.</span>
</span><span id="Utils.function_xlsx_input-405"><a href="#Utils.function_xlsx_input-405"><span class="linenos">405</span></a><span class="sd">        </span>
</span><span id="Utils.function_xlsx_input-406"><a href="#Utils.function_xlsx_input-406"><span class="linenos">406</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.function_xlsx_input-407"><a href="#Utils.function_xlsx_input-407"><span class="linenos">407</span></a>
</span><span id="Utils.function_xlsx_input-408"><a href="#Utils.function_xlsx_input-408"><span class="linenos">408</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="Utils.function_xlsx_input-409"><a href="#Utils.function_xlsx_input-409"><span class="linenos">409</span></a>
</span><span id="Utils.function_xlsx_input-410"><a href="#Utils.function_xlsx_input-410"><span class="linenos">410</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="Utils.function_xlsx_input-411"><a href="#Utils.function_xlsx_input-411"><span class="linenos">411</span></a>
</span><span id="Utils.function_xlsx_input-412"><a href="#Utils.function_xlsx_input-412"><span class="linenos">412</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="Utils.function_xlsx_input-413"><a href="#Utils.function_xlsx_input-413"><span class="linenos">413</span></a>
</span><span id="Utils.function_xlsx_input-414"><a href="#Utils.function_xlsx_input-414"><span class="linenos">414</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;xlsx&#39;.</span>
</span><span id="Utils.function_xlsx_input-415"><a href="#Utils.function_xlsx_input-415"><span class="linenos">415</span></a>
</span><span id="Utils.function_xlsx_input-416"><a href="#Utils.function_xlsx_input-416"><span class="linenos">416</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="Utils.function_xlsx_input-417"><a href="#Utils.function_xlsx_input-417"><span class="linenos">417</span></a><span class="sd">        </span>
</span><span id="Utils.function_xlsx_input-418"><a href="#Utils.function_xlsx_input-418"><span class="linenos">418</span></a><span class="sd">            </span>
</span><span id="Utils.function_xlsx_input-419"><a href="#Utils.function_xlsx_input-419"><span class="linenos">419</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.function_xlsx_input-420"><a href="#Utils.function_xlsx_input-420"><span class="linenos">420</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="Utils.function_xlsx_input-421"><a href="#Utils.function_xlsx_input-421"><span class="linenos">421</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.function_xlsx_input-422"><a href="#Utils.function_xlsx_input-422"><span class="linenos">422</span></a>
</span><span id="Utils.function_xlsx_input-423"><a href="#Utils.function_xlsx_input-423"><span class="linenos">423</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils.function_xlsx_input-424"><a href="#Utils.function_xlsx_input-424"><span class="linenos">424</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;xlsx&quot;</span><span class="p">:</span>
</span><span id="Utils.function_xlsx_input-425"><a href="#Utils.function_xlsx_input-425"><span class="linenos">425</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils.function_xlsx_input-426"><a href="#Utils.function_xlsx_input-426"><span class="linenos">426</span></a>
</span><span id="Utils.function_xlsx_input-427"><a href="#Utils.function_xlsx_input-427"><span class="linenos">427</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;xlsx&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils.function_xlsx_input-428"><a href="#Utils.function_xlsx_input-428"><span class="linenos">428</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="Utils.function_xlsx_input-429"><a href="#Utils.function_xlsx_input-429"><span class="linenos">429</span></a>
</span><span id="Utils.function_xlsx_input-430"><a href="#Utils.function_xlsx_input-430"><span class="linenos">430</span></a>            <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">expected_df</span><span class="p">,</span> <span class="n">df_result</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span><span id="Utils.function_xlsx_input-431"><a href="#Utils.function_xlsx_input-431"><span class="linenos">431</span></a>
</span><span id="Utils.function_xlsx_input-432"><a href="#Utils.function_xlsx_input-432"><span class="linenos">432</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils.function_xlsx_input-433"><a href="#Utils.function_xlsx_input-433"><span class="linenos">433</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>    
</span><span id="Utils.function_xlsx_input-434"><a href="#Utils.function_xlsx_input-434"><span class="linenos">434</span></a>
</span><span id="Utils.function_xlsx_input-435"><a href="#Utils.function_xlsx_input-435"><span class="linenos">435</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span> 
</span></pre></div>


            <div class="docstring"><p>Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from an XLSX file.</p>

<p>Parameters:</p>

<pre><code>- 'function' (callable): The function to be tested.

- 'list_func_param' (list): The list of parameters to be passed to the function.

- 'file_path' (str): The path to the file.

- 'file_type' (str): The type of the file. In this case, it should be 'xlsx'.

- 'options' (dict): Options for reading the file.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</p>
</div>


                            </div>
                            <div id="Utils.function_json_input" class="classattr">
                                        <input id="Utils.function_json_input-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function_json_input</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">function</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">callable</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span>,</span><span class="param">	<span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.function_json_input-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.function_json_input"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.function_json_input-438"><a href="#Utils.function_json_input-438"><span class="linenos">438</span></a>    <span class="k">def</span> <span class="nf">function_json_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span> <span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
</span><span id="Utils.function_json_input-439"><a href="#Utils.function_json_input-439"><span class="linenos">439</span></a>
</span><span id="Utils.function_json_input-440"><a href="#Utils.function_json_input-440"><span class="linenos">440</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.function_json_input-441"><a href="#Utils.function_json_input-441"><span class="linenos">441</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a JSON file.</span>
</span><span id="Utils.function_json_input-442"><a href="#Utils.function_json_input-442"><span class="linenos">442</span></a><span class="sd">        </span>
</span><span id="Utils.function_json_input-443"><a href="#Utils.function_json_input-443"><span class="linenos">443</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.function_json_input-444"><a href="#Utils.function_json_input-444"><span class="linenos">444</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="Utils.function_json_input-445"><a href="#Utils.function_json_input-445"><span class="linenos">445</span></a>
</span><span id="Utils.function_json_input-446"><a href="#Utils.function_json_input-446"><span class="linenos">446</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="Utils.function_json_input-447"><a href="#Utils.function_json_input-447"><span class="linenos">447</span></a>
</span><span id="Utils.function_json_input-448"><a href="#Utils.function_json_input-448"><span class="linenos">448</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="Utils.function_json_input-449"><a href="#Utils.function_json_input-449"><span class="linenos">449</span></a>
</span><span id="Utils.function_json_input-450"><a href="#Utils.function_json_input-450"><span class="linenos">450</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;json&#39;.</span>
</span><span id="Utils.function_json_input-451"><a href="#Utils.function_json_input-451"><span class="linenos">451</span></a>
</span><span id="Utils.function_json_input-452"><a href="#Utils.function_json_input-452"><span class="linenos">452</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="Utils.function_json_input-453"><a href="#Utils.function_json_input-453"><span class="linenos">453</span></a>
</span><span id="Utils.function_json_input-454"><a href="#Utils.function_json_input-454"><span class="linenos">454</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.function_json_input-455"><a href="#Utils.function_json_input-455"><span class="linenos">455</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="Utils.function_json_input-456"><a href="#Utils.function_json_input-456"><span class="linenos">456</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.function_json_input-457"><a href="#Utils.function_json_input-457"><span class="linenos">457</span></a>
</span><span id="Utils.function_json_input-458"><a href="#Utils.function_json_input-458"><span class="linenos">458</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils.function_json_input-459"><a href="#Utils.function_json_input-459"><span class="linenos">459</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;json&quot;</span><span class="p">:</span>
</span><span id="Utils.function_json_input-460"><a href="#Utils.function_json_input-460"><span class="linenos">460</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils.function_json_input-461"><a href="#Utils.function_json_input-461"><span class="linenos">461</span></a>
</span><span id="Utils.function_json_input-462"><a href="#Utils.function_json_input-462"><span class="linenos">462</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;json&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils.function_json_input-463"><a href="#Utils.function_json_input-463"><span class="linenos">463</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="Utils.function_json_input-464"><a href="#Utils.function_json_input-464"><span class="linenos">464</span></a>
</span><span id="Utils.function_json_input-465"><a href="#Utils.function_json_input-465"><span class="linenos">465</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils.function_json_input-466"><a href="#Utils.function_json_input-466"><span class="linenos">466</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  
</span><span id="Utils.function_json_input-467"><a href="#Utils.function_json_input-467"><span class="linenos">467</span></a>
</span><span id="Utils.function_json_input-468"><a href="#Utils.function_json_input-468"><span class="linenos">468</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a JSON file.</p>

<p>Parameters:
    - 'function' (callable): The function to be tested.</p>

<pre><code>- 'list_func_param' (list): The list of parameters to be passed to the function.

- 'file_path' (str): The path to the file.

- 'file_type' (str): The type of the file. In this case, it should be 'json'.

- 'options' (dict): Options for reading the file.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</p>
</div>


                            </div>
                            <div id="Utils.function_parquet_input" class="classattr">
                                        <input id="Utils.function_parquet_input-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">function_parquet_input</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">function</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">callable</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span>,</span><span class="param">	<span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.function_parquet_input-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.function_parquet_input"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.function_parquet_input-470"><a href="#Utils.function_parquet_input-470"><span class="linenos">470</span></a>    <span class="k">def</span> <span class="nf">function_parquet_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">:</span> <span class="nb">callable</span><span class="p">,</span> <span class="n">list_func_param</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">file_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span> <span class="p">):</span>
</span><span id="Utils.function_parquet_input-471"><a href="#Utils.function_parquet_input-471"><span class="linenos">471</span></a><span class="w">        </span>
</span><span id="Utils.function_parquet_input-472"><a href="#Utils.function_parquet_input-472"><span class="linenos">472</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.function_parquet_input-473"><a href="#Utils.function_parquet_input-473"><span class="linenos">473</span></a><span class="sd">        Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a Parquet file.</span>
</span><span id="Utils.function_parquet_input-474"><a href="#Utils.function_parquet_input-474"><span class="linenos">474</span></a><span class="sd">        </span>
</span><span id="Utils.function_parquet_input-475"><a href="#Utils.function_parquet_input-475"><span class="linenos">475</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.function_parquet_input-476"><a href="#Utils.function_parquet_input-476"><span class="linenos">476</span></a><span class="sd">            - &#39;function&#39; (callable): The function to be tested.</span>
</span><span id="Utils.function_parquet_input-477"><a href="#Utils.function_parquet_input-477"><span class="linenos">477</span></a>
</span><span id="Utils.function_parquet_input-478"><a href="#Utils.function_parquet_input-478"><span class="linenos">478</span></a><span class="sd">            - &#39;list_func_param&#39; (list): The list of parameters to be passed to the function.</span>
</span><span id="Utils.function_parquet_input-479"><a href="#Utils.function_parquet_input-479"><span class="linenos">479</span></a>
</span><span id="Utils.function_parquet_input-480"><a href="#Utils.function_parquet_input-480"><span class="linenos">480</span></a><span class="sd">            - &#39;file_path&#39; (str): The path to the file.</span>
</span><span id="Utils.function_parquet_input-481"><a href="#Utils.function_parquet_input-481"><span class="linenos">481</span></a>
</span><span id="Utils.function_parquet_input-482"><a href="#Utils.function_parquet_input-482"><span class="linenos">482</span></a><span class="sd">            - &#39;file_type&#39; (str): The type of the file. In this case, it should be &#39;parquet&#39;.</span>
</span><span id="Utils.function_parquet_input-483"><a href="#Utils.function_parquet_input-483"><span class="linenos">483</span></a>
</span><span id="Utils.function_parquet_input-484"><a href="#Utils.function_parquet_input-484"><span class="linenos">484</span></a><span class="sd">            - &#39;options&#39; (dict): Options for reading the file.</span>
</span><span id="Utils.function_parquet_input-485"><a href="#Utils.function_parquet_input-485"><span class="linenos">485</span></a>
</span><span id="Utils.function_parquet_input-486"><a href="#Utils.function_parquet_input-486"><span class="linenos">486</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.function_parquet_input-487"><a href="#Utils.function_parquet_input-487"><span class="linenos">487</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</span>
</span><span id="Utils.function_parquet_input-488"><a href="#Utils.function_parquet_input-488"><span class="linenos">488</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.function_parquet_input-489"><a href="#Utils.function_parquet_input-489"><span class="linenos">489</span></a>
</span><span id="Utils.function_parquet_input-490"><a href="#Utils.function_parquet_input-490"><span class="linenos">490</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Utils.function_parquet_input-491"><a href="#Utils.function_parquet_input-491"><span class="linenos">491</span></a>            <span class="k">if</span> <span class="n">file_type</span> <span class="o">!=</span> <span class="s2">&quot;parquet&quot;</span><span class="p">:</span>
</span><span id="Utils.function_parquet_input-492"><a href="#Utils.function_parquet_input-492"><span class="linenos">492</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">file_type</span><span class="si">}</span><span class="s2"> is not supported by this method, there are other methods function_type_file_input where you just need to replace type_file with the file type. The supported file types are: xlsx/csv/txt/parquet/json&quot;</span><span class="p">)</span>
</span><span id="Utils.function_parquet_input-493"><a href="#Utils.function_parquet_input-493"><span class="linenos">493</span></a>
</span><span id="Utils.function_parquet_input-494"><a href="#Utils.function_parquet_input-494"><span class="linenos">494</span></a>            <span class="n">expected_df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;parquet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils.function_parquet_input-495"><a href="#Utils.function_parquet_input-495"><span class="linenos">495</span></a>            <span class="n">df_result</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="o">*</span><span class="n">list_func_param</span><span class="p">)</span>
</span><span id="Utils.function_parquet_input-496"><a href="#Utils.function_parquet_input-496"><span class="linenos">496</span></a>
</span><span id="Utils.function_parquet_input-497"><a href="#Utils.function_parquet_input-497"><span class="linenos">497</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils.function_parquet_input-498"><a href="#Utils.function_parquet_input-498"><span class="linenos">498</span></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while reading the file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>       
</span><span id="Utils.function_parquet_input-499"><a href="#Utils.function_parquet_input-499"><span class="linenos">499</span></a>
</span><span id="Utils.function_parquet_input-500"><a href="#Utils.function_parquet_input-500"><span class="linenos">500</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">df_result</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span> <span class="p">,</span> <span class="s2">&quot;The output of the function does not match the expected DataFrame.&quot;</span> 
</span></pre></div>


            <div class="docstring"><p>Applies a given function to a set of parameters and tests the resulting DataFrame by comparing it to an expected DataFrame created from a Parquet file.</p>

<p>Parameters:
    - 'function' (callable): The function to be tested.</p>

<pre><code>- 'list_func_param' (list): The list of parameters to be passed to the function.

- 'file_path' (str): The path to the file.

- 'file_type' (str): The type of the file. In this case, it should be 'parquet'.

- 'options' (dict): Options for reading the file.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the DataFrame returned by the function does not match the expected DataFrame.</p>
</div>


                            </div>
                            <div id="Utils.duplicates_df" class="classattr">
                                        <input id="Utils.duplicates_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">duplicates_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">df_to_test</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.duplicates_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.duplicates_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.duplicates_df-503"><a href="#Utils.duplicates_df-503"><span class="linenos">503</span></a>    <span class="k">def</span> <span class="nf">duplicates_df</span><span class="p">(</span><span class="bp">self</span> <span class="p">,</span> <span class="n">df_to_test</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Utils.duplicates_df-504"><a href="#Utils.duplicates_df-504"><span class="linenos">504</span></a>
</span><span id="Utils.duplicates_df-505"><a href="#Utils.duplicates_df-505"><span class="linenos">505</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.duplicates_df-506"><a href="#Utils.duplicates_df-506"><span class="linenos">506</span></a><span class="sd">        Checks if a DataFrame has duplicate rows.</span>
</span><span id="Utils.duplicates_df-507"><a href="#Utils.duplicates_df-507"><span class="linenos">507</span></a><span class="sd">        </span>
</span><span id="Utils.duplicates_df-508"><a href="#Utils.duplicates_df-508"><span class="linenos">508</span></a><span class="sd">        This function counts the total number of rows and the number of distinct rows in the DataFrame. </span>
</span><span id="Utils.duplicates_df-509"><a href="#Utils.duplicates_df-509"><span class="linenos">509</span></a><span class="sd">        If the two counts are not equal, it means there are duplicate rows in the DataFrame, and the function raises an AssertionError.</span>
</span><span id="Utils.duplicates_df-510"><a href="#Utils.duplicates_df-510"><span class="linenos">510</span></a><span class="sd">        </span>
</span><span id="Utils.duplicates_df-511"><a href="#Utils.duplicates_df-511"><span class="linenos">511</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.duplicates_df-512"><a href="#Utils.duplicates_df-512"><span class="linenos">512</span></a>
</span><span id="Utils.duplicates_df-513"><a href="#Utils.duplicates_df-513"><span class="linenos">513</span></a><span class="sd">            - &#39;df_to_test&#39; (DataFrame): The DataFrame to be checked for duplicates.</span>
</span><span id="Utils.duplicates_df-514"><a href="#Utils.duplicates_df-514"><span class="linenos">514</span></a><span class="sd">            </span>
</span><span id="Utils.duplicates_df-515"><a href="#Utils.duplicates_df-515"><span class="linenos">515</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.duplicates_df-516"><a href="#Utils.duplicates_df-516"><span class="linenos">516</span></a><span class="sd">            None. Raises an AssertionError if the DataFrame has duplicate values.</span>
</span><span id="Utils.duplicates_df-517"><a href="#Utils.duplicates_df-517"><span class="linenos">517</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.duplicates_df-518"><a href="#Utils.duplicates_df-518"><span class="linenos">518</span></a>
</span><span id="Utils.duplicates_df-519"><a href="#Utils.duplicates_df-519"><span class="linenos">519</span></a>        <span class="n">duplicate_df</span> <span class="o">=</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="n">df_to_test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;count &gt; 1&quot;</span><span class="p">)</span>
</span><span id="Utils.duplicates_df-520"><a href="#Utils.duplicates_df-520"><span class="linenos">520</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">duplicate_df</span><span class="p">)</span>
</span><span id="Utils.duplicates_df-521"><a href="#Utils.duplicates_df-521"><span class="linenos">521</span></a>        <span class="k">assert</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="p">,</span> <span class="s2">&quot;There are duplicate entries in the DataFrame.&quot;</span> 
</span></pre></div>


            <div class="docstring"><p>Checks if a DataFrame has duplicate rows.</p>

<p>This function counts the total number of rows and the number of distinct rows in the DataFrame. 
If the two counts are not equal, it means there are duplicate rows in the DataFrame, and the function raises an AssertionError.</p>

<p>Parameters:</p>

<pre><code>- 'df_to_test' (DataFrame): The DataFrame to be checked for duplicates.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the DataFrame has duplicate values.</p>
</div>


                            </div>
                            <div id="Utils.duplicates_col" class="classattr">
                                        <input id="Utils.duplicates_col-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">duplicates_col</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">df_to_test</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span>, </span><span class="param"><span class="n">col_name</span><span class="p">:</span> <span class="nb">list</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.duplicates_col-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.duplicates_col"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.duplicates_col-524"><a href="#Utils.duplicates_col-524"><span class="linenos">524</span></a>    <span class="k">def</span> <span class="nf">duplicates_col</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">df_to_test</span> <span class="p">:</span> <span class="n">DataFrame</span> <span class="p">,</span> <span class="n">col_name</span> <span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="Utils.duplicates_col-525"><a href="#Utils.duplicates_col-525"><span class="linenos">525</span></a>
</span><span id="Utils.duplicates_col-526"><a href="#Utils.duplicates_col-526"><span class="linenos">526</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.duplicates_col-527"><a href="#Utils.duplicates_col-527"><span class="linenos">527</span></a><span class="sd">        Checks if a column in a DataFrame has duplicate values.</span>
</span><span id="Utils.duplicates_col-528"><a href="#Utils.duplicates_col-528"><span class="linenos">528</span></a><span class="sd">        </span>
</span><span id="Utils.duplicates_col-529"><a href="#Utils.duplicates_col-529"><span class="linenos">529</span></a><span class="sd">        This function counts the total number of values and the number of distinct values in the specified column of the DataFrame. </span>
</span><span id="Utils.duplicates_col-530"><a href="#Utils.duplicates_col-530"><span class="linenos">530</span></a><span class="sd">        If the two counts are not equal, it means there are duplicate values in the column, and the function raises an AssertionError.</span>
</span><span id="Utils.duplicates_col-531"><a href="#Utils.duplicates_col-531"><span class="linenos">531</span></a><span class="sd">        </span>
</span><span id="Utils.duplicates_col-532"><a href="#Utils.duplicates_col-532"><span class="linenos">532</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.duplicates_col-533"><a href="#Utils.duplicates_col-533"><span class="linenos">533</span></a>
</span><span id="Utils.duplicates_col-534"><a href="#Utils.duplicates_col-534"><span class="linenos">534</span></a><span class="sd">            - &#39;df_to_test&#39; (DataFrame): The DataFrame to be checked for duplicates.</span>
</span><span id="Utils.duplicates_col-535"><a href="#Utils.duplicates_col-535"><span class="linenos">535</span></a>
</span><span id="Utils.duplicates_col-536"><a href="#Utils.duplicates_col-536"><span class="linenos">536</span></a><span class="sd">            - &#39;col_name&#39; (str): The name of the column to be checked for duplicates.</span>
</span><span id="Utils.duplicates_col-537"><a href="#Utils.duplicates_col-537"><span class="linenos">537</span></a><span class="sd">            </span>
</span><span id="Utils.duplicates_col-538"><a href="#Utils.duplicates_col-538"><span class="linenos">538</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.duplicates_col-539"><a href="#Utils.duplicates_col-539"><span class="linenos">539</span></a><span class="sd">            None. Raises an AssertionError if the column in the DataFrame has duplicate values.</span>
</span><span id="Utils.duplicates_col-540"><a href="#Utils.duplicates_col-540"><span class="linenos">540</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.duplicates_col-541"><a href="#Utils.duplicates_col-541"><span class="linenos">541</span></a>        
</span><span id="Utils.duplicates_col-542"><a href="#Utils.duplicates_col-542"><span class="linenos">542</span></a>        <span class="n">duplicate_df</span> <span class="o">=</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">groupBy</span><span class="p">(</span><span class="n">df_to_test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s2">&quot;count &gt; 1&quot;</span><span class="p">)</span>
</span><span id="Utils.duplicates_col-543"><a href="#Utils.duplicates_col-543"><span class="linenos">543</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">duplicate_df</span><span class="p">)</span>
</span><span id="Utils.duplicates_col-544"><a href="#Utils.duplicates_col-544"><span class="linenos">544</span></a>        <span class="k">for</span> <span class="n">colonne</span> <span class="ow">in</span> <span class="n">col_name</span><span class="p">:</span>
</span><span id="Utils.duplicates_col-545"><a href="#Utils.duplicates_col-545"><span class="linenos">545</span></a>            <span class="k">assert</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">colonne</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="n">df_to_test</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">colonne</span><span class="p">)</span><span class="o">.</span><span class="n">distinct</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="s2">&quot;There are duplicate entries in the DataFrame.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Checks if a column in a DataFrame has duplicate values.</p>

<p>This function counts the total number of values and the number of distinct values in the specified column of the DataFrame. 
If the two counts are not equal, it means there are duplicate values in the column, and the function raises an AssertionError.</p>

<p>Parameters:</p>

<pre><code>- 'df_to_test' (DataFrame): The DataFrame to be checked for duplicates.

- 'col_name' (str): The name of the column to be checked for duplicates.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the column in the DataFrame has duplicate values.</p>
</div>


                            </div>
                            <div id="Utils.filter_by_condition" class="classattr">
                                        <input id="Utils.filter_by_condition-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_by_condition</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">filter_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">condition</span>,</span><span class="param">	<span class="n">expected_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.filter_by_condition-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.filter_by_condition"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.filter_by_condition-548"><a href="#Utils.filter_by_condition-548"><span class="linenos">548</span></a>    <span class="k">def</span> <span class="nf">filter_by_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">condition</span> <span class="p">,</span> <span class="n">expected_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Utils.filter_by_condition-549"><a href="#Utils.filter_by_condition-549"><span class="linenos">549</span></a>
</span><span id="Utils.filter_by_condition-550"><a href="#Utils.filter_by_condition-550"><span class="linenos">550</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.filter_by_condition-551"><a href="#Utils.filter_by_condition-551"><span class="linenos">551</span></a><span class="sd">        This function filters a DataFrame based on a provided condition and then checks the filtered DataFrame against an expected DataFrame.</span>
</span><span id="Utils.filter_by_condition-552"><a href="#Utils.filter_by_condition-552"><span class="linenos">552</span></a><span class="sd">        </span>
</span><span id="Utils.filter_by_condition-553"><a href="#Utils.filter_by_condition-553"><span class="linenos">553</span></a><span class="sd">        It applies a filter to the DataFrame based on the provided condition. The filtered DataFrame is then checked against the expected DataFrame using the `filter_by_df` function.</span>
</span><span id="Utils.filter_by_condition-554"><a href="#Utils.filter_by_condition-554"><span class="linenos">554</span></a><span class="sd">        </span>
</span><span id="Utils.filter_by_condition-555"><a href="#Utils.filter_by_condition-555"><span class="linenos">555</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.filter_by_condition-556"><a href="#Utils.filter_by_condition-556"><span class="linenos">556</span></a>
</span><span id="Utils.filter_by_condition-557"><a href="#Utils.filter_by_condition-557"><span class="linenos">557</span></a><span class="sd">            - &#39;filter_df&#39; (DataFrame): The DataFrame to be filtered.</span>
</span><span id="Utils.filter_by_condition-558"><a href="#Utils.filter_by_condition-558"><span class="linenos">558</span></a>
</span><span id="Utils.filter_by_condition-559"><a href="#Utils.filter_by_condition-559"><span class="linenos">559</span></a><span class="sd">            - &#39;condition&#39;: The condition to be used for filtering the DataFrame.</span>
</span><span id="Utils.filter_by_condition-560"><a href="#Utils.filter_by_condition-560"><span class="linenos">560</span></a>
</span><span id="Utils.filter_by_condition-561"><a href="#Utils.filter_by_condition-561"><span class="linenos">561</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame): The expected DataFrame after filtering.</span>
</span><span id="Utils.filter_by_condition-562"><a href="#Utils.filter_by_condition-562"><span class="linenos">562</span></a><span class="sd">                </span>
</span><span id="Utils.filter_by_condition-563"><a href="#Utils.filter_by_condition-563"><span class="linenos">563</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.filter_by_condition-564"><a href="#Utils.filter_by_condition-564"><span class="linenos">564</span></a><span class="sd">            None. The function will raise an AssertionError if the filtered DataFrame does not match the expected DataFrame.</span>
</span><span id="Utils.filter_by_condition-565"><a href="#Utils.filter_by_condition-565"><span class="linenos">565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.filter_by_condition-566"><a href="#Utils.filter_by_condition-566"><span class="linenos">566</span></a>
</span><span id="Utils.filter_by_condition-567"><a href="#Utils.filter_by_condition-567"><span class="linenos">567</span></a>        <span class="n">df_filtered</span> <span class="o">=</span> <span class="n">filter_df</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>
</span><span id="Utils.filter_by_condition-568"><a href="#Utils.filter_by_condition-568"><span class="linenos">568</span></a>        <span class="n">Utils</span><span class="o">.</span><span class="n">filter_by_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_df</span> <span class="p">,</span> <span class="n">expected_df</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This function filters a DataFrame based on a provided condition and then checks the filtered DataFrame against an expected DataFrame.</p>

<p>It applies a filter to the DataFrame based on the provided condition. The filtered DataFrame is then checked against the expected DataFrame using the <code><a href="#Utils.filter_by_df">filter_by_df</a></code> function.</p>

<p>Parameters:</p>

<pre><code>- 'filter_df' (DataFrame): The DataFrame to be filtered.

- 'condition': The condition to be used for filtering the DataFrame.

- 'expected_df' (DataFrame): The expected DataFrame after filtering.
</code></pre>

<p>Returns:
    None. The function will raise an AssertionError if the filtered DataFrame does not match the expected DataFrame.</p>
</div>


                            </div>
                            <div id="Utils.filter_by_df" class="classattr">
                                        <input id="Utils.filter_by_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">filter_by_df</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">filter_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">expected_df</span><span class="p">:</span> <span class="n">pyspark</span><span class="o">.</span><span class="n">sql</span><span class="o">.</span><span class="n">dataframe</span><span class="o">.</span><span class="n">DataFrame</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.filter_by_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.filter_by_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.filter_by_df-572"><a href="#Utils.filter_by_df-572"><span class="linenos">572</span></a>    <span class="k">def</span> <span class="nf">filter_by_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filter_df</span><span class="p">:</span> <span class="n">DataFrame</span><span class="p">,</span> <span class="n">expected_df</span> <span class="p">:</span> <span class="n">DataFrame</span><span class="p">):</span>
</span><span id="Utils.filter_by_df-573"><a href="#Utils.filter_by_df-573"><span class="linenos">573</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.filter_by_df-574"><a href="#Utils.filter_by_df-574"><span class="linenos">574</span></a><span class="sd">        This function checks if a filtered DataFrame matches an expected DataFrame.</span>
</span><span id="Utils.filter_by_df-575"><a href="#Utils.filter_by_df-575"><span class="linenos">575</span></a><span class="sd">        </span>
</span><span id="Utils.filter_by_df-576"><a href="#Utils.filter_by_df-576"><span class="linenos">576</span></a><span class="sd">        It applies a filter to the DataFrame based on the provided condition. Then, it checks if any rows from the filtered DataFrame exist in the unfiltered DataFrame. If they do, an AssertionError is raised. Finally, it checks if the filtered DataFrame matches the expected DataFrame using the `assertDataFrameEqual` function.</span>
</span><span id="Utils.filter_by_df-577"><a href="#Utils.filter_by_df-577"><span class="linenos">577</span></a><span class="sd">        </span>
</span><span id="Utils.filter_by_df-578"><a href="#Utils.filter_by_df-578"><span class="linenos">578</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.filter_by_df-579"><a href="#Utils.filter_by_df-579"><span class="linenos">579</span></a>
</span><span id="Utils.filter_by_df-580"><a href="#Utils.filter_by_df-580"><span class="linenos">580</span></a><span class="sd">            - &#39;filter_df&#39; (DataFrame) : The DataFrame to be filtered.</span>
</span><span id="Utils.filter_by_df-581"><a href="#Utils.filter_by_df-581"><span class="linenos">581</span></a>
</span><span id="Utils.filter_by_df-582"><a href="#Utils.filter_by_df-582"><span class="linenos">582</span></a><span class="sd">            - &#39;expected_df&#39; (DataFrame) : The expected DataFrame after filtering.</span>
</span><span id="Utils.filter_by_df-583"><a href="#Utils.filter_by_df-583"><span class="linenos">583</span></a><span class="sd">                </span>
</span><span id="Utils.filter_by_df-584"><a href="#Utils.filter_by_df-584"><span class="linenos">584</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.filter_by_df-585"><a href="#Utils.filter_by_df-585"><span class="linenos">585</span></a><span class="sd">            None. Raises an AssertionError if the filtered DataFrame does not match the expected DataFrame or if any rows from the filtered DataFrame exist in the unfiltered DataFrame.</span>
</span><span id="Utils.filter_by_df-586"><a href="#Utils.filter_by_df-586"><span class="linenos">586</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.filter_by_df-587"><a href="#Utils.filter_by_df-587"><span class="linenos">587</span></a>
</span><span id="Utils.filter_by_df-588"><a href="#Utils.filter_by_df-588"><span class="linenos">588</span></a>        <span class="n">df_unfiltered</span> <span class="o">=</span> <span class="n">filter_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">expected_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">filter_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left_anti&quot;</span><span class="p">)</span>
</span><span id="Utils.filter_by_df-589"><a href="#Utils.filter_by_df-589"><span class="linenos">589</span></a>        <span class="n">df_filtered_condition</span> <span class="o">=</span> <span class="n">expected_df</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filter_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">filter_df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left_anti&quot;</span><span class="p">)</span>
</span><span id="Utils.filter_by_df-590"><a href="#Utils.filter_by_df-590"><span class="linenos">590</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">df_filtered_condition</span><span class="p">)</span>
</span><span id="Utils.filter_by_df-591"><a href="#Utils.filter_by_df-591"><span class="linenos">591</span></a>        <span class="n">display</span><span class="p">(</span><span class="n">df_unfiltered</span><span class="p">)</span>
</span><span id="Utils.filter_by_df-592"><a href="#Utils.filter_by_df-592"><span class="linenos">592</span></a>
</span><span id="Utils.filter_by_df-593"><a href="#Utils.filter_by_df-593"><span class="linenos">593</span></a>        <span class="k">assert</span> <span class="n">df_unfiltered</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;The filtering condition did not exclude all expected rows.&quot;</span>
</span><span id="Utils.filter_by_df-594"><a href="#Utils.filter_by_df-594"><span class="linenos">594</span></a>        <span class="k">assert</span> <span class="n">df_filtered_condition</span><span class="o">.</span><span class="n">count</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;The filtering condition excluded some unexpected rows.&quot;</span>
</span><span id="Utils.filter_by_df-595"><a href="#Utils.filter_by_df-595"><span class="linenos">595</span></a>
</span><span id="Utils.filter_by_df-596"><a href="#Utils.filter_by_df-596"><span class="linenos">596</span></a>        <span class="n">assertDataFrameEqual</span><span class="p">(</span><span class="n">filter_df</span><span class="p">,</span> <span class="n">expected_df</span><span class="p">),</span> <span class="s2">&quot;The filtered DataFrame does not match the expected DataFrame.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>This function checks if a filtered DataFrame matches an expected DataFrame.</p>

<p>It applies a filter to the DataFrame based on the provided condition. Then, it checks if any rows from the filtered DataFrame exist in the unfiltered DataFrame. If they do, an AssertionError is raised. Finally, it checks if the filtered DataFrame matches the expected DataFrame using the <code>assertDataFrameEqual</code> function.</p>

<p>Parameters:</p>

<pre><code>- 'filter_df' (DataFrame) : The DataFrame to be filtered.

- 'expected_df' (DataFrame) : The expected DataFrame after filtering.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the filtered DataFrame does not match the expected DataFrame or if any rows from the filtered DataFrame exist in the unfiltered DataFrame.</p>
</div>


                            </div>
                            <div id="Utils.write_df" class="classattr">
                                        <input id="Utils.write_df-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_df</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Utils.write_df-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Utils.write_df"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Utils.write_df-599"><a href="#Utils.write_df-599"><span class="linenos">599</span></a>    <span class="k">def</span> <span class="nf">write_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="Utils.write_df-600"><a href="#Utils.write_df-600"><span class="linenos">600</span></a>
</span><span id="Utils.write_df-601"><a href="#Utils.write_df-601"><span class="linenos">601</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Utils.write_df-602"><a href="#Utils.write_df-602"><span class="linenos">602</span></a><span class="sd">        Checks if a file exists at the specified path.</span>
</span><span id="Utils.write_df-603"><a href="#Utils.write_df-603"><span class="linenos">603</span></a><span class="sd">        </span>
</span><span id="Utils.write_df-604"><a href="#Utils.write_df-604"><span class="linenos">604</span></a><span class="sd">        This function splits the file path to get its type, then checks if a file exists at the given location. If the check fails, the function raises an AssertionError.</span>
</span><span id="Utils.write_df-605"><a href="#Utils.write_df-605"><span class="linenos">605</span></a><span class="sd">        </span>
</span><span id="Utils.write_df-606"><a href="#Utils.write_df-606"><span class="linenos">606</span></a><span class="sd">        Parameters:</span>
</span><span id="Utils.write_df-607"><a href="#Utils.write_df-607"><span class="linenos">607</span></a><span class="sd">        </span>
</span><span id="Utils.write_df-608"><a href="#Utils.write_df-608"><span class="linenos">608</span></a><span class="sd">            - &#39;file_path&#39; (str): The file path.</span>
</span><span id="Utils.write_df-609"><a href="#Utils.write_df-609"><span class="linenos">609</span></a><span class="sd">                    </span>
</span><span id="Utils.write_df-610"><a href="#Utils.write_df-610"><span class="linenos">610</span></a><span class="sd">        Returns:</span>
</span><span id="Utils.write_df-611"><a href="#Utils.write_df-611"><span class="linenos">611</span></a><span class="sd">            None. Raises an AssertionError if the file does not exist at the specified path.</span>
</span><span id="Utils.write_df-612"><a href="#Utils.write_df-612"><span class="linenos">612</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Utils.write_df-613"><a href="#Utils.write_df-613"><span class="linenos">613</span></a>        
</span><span id="Utils.write_df-614"><a href="#Utils.write_df-614"><span class="linenos">614</span></a>        <span class="n">start_path</span> <span class="o">=</span> <span class="n">file_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Utils.write_df-615"><a href="#Utils.write_df-615"><span class="linenos">615</span></a>        <span class="n">start_accepted</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;abfss&quot;</span><span class="p">,</span> <span class="s2">&quot;https&quot;</span> <span class="p">,</span> <span class="s2">&quot;adl&quot;</span><span class="p">]</span>
</span><span id="Utils.write_df-616"><a href="#Utils.write_df-616"><span class="linenos">616</span></a>
</span><span id="Utils.write_df-617"><a href="#Utils.write_df-617"><span class="linenos">617</span></a>        <span class="k">if</span> <span class="n">start_path</span> <span class="ow">in</span> <span class="n">start_accepted</span><span class="p">:</span>
</span><span id="Utils.write_df-618"><a href="#Utils.write_df-618"><span class="linenos">618</span></a>
</span><span id="Utils.write_df-619"><a href="#Utils.write_df-619"><span class="linenos">619</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Utils.write_df-620"><a href="#Utils.write_df-620"><span class="linenos">620</span></a>                <span class="n">file_list</span> <span class="o">=</span> <span class="n">dbutils</span><span class="o">.</span><span class="n">fs</span><span class="o">.</span><span class="n">ls</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</span><span id="Utils.write_df-621"><a href="#Utils.write_df-621"><span class="linenos">621</span></a>
</span><span id="Utils.write_df-622"><a href="#Utils.write_df-622"><span class="linenos">622</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Utils.write_df-623"><a href="#Utils.write_df-623"><span class="linenos">623</span></a>                <span class="k">raise</span> <span class="ne">AssertionError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The file does not exist at the specified path : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="Utils.write_df-624"><a href="#Utils.write_df-624"><span class="linenos">624</span></a>
</span><span id="Utils.write_df-625"><a href="#Utils.write_df-625"><span class="linenos">625</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Utils.write_df-626"><a href="#Utils.write_df-626"><span class="linenos">626</span></a>            <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span> <span class="s2">&quot;The file does not exist at the specified path.&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Checks if a file exists at the specified path.</p>

<p>This function splits the file path to get its type, then checks if a file exists at the given location. If the check fails, the function raises an AssertionError.</p>

<p>Parameters:</p>

<pre><code>- 'file_path' (str): The file path.
</code></pre>

<p>Returns:
    None. Raises an AssertionError if the file does not exist at the specified path.</p>
</div>


                            </div>
                </section>
    </main>
</body>
</html>